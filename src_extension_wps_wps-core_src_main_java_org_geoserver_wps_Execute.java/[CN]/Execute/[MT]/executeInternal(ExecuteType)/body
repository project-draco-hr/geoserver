{
  Name processName=Ows11Util.name(request.getIdentifier());
  ProcessFactory pf=Processors.createProcessFactory(processName);
  if (pf == null) {
    throw new WPSException("No such process: " + processName);
  }
  Map<String,Object> inputs=parseProcessInputs(request,processName,pf);
  Map<String,Object> result=null;
  ProcessListener listener=new ProcessListener();
  Throwable exception=null;
  try {
    Process p=pf.create(processName);
    result=p.execute(inputs,listener);
  }
 catch (  Exception e) {
    exception=e;
  }
  if (exception == null) {
    exception=listener.exception;
  }
  if (exception != null) {
    if (exception instanceof WPSException) {
      throw (WPSException)exception;
    }
 else     if (exception instanceof ProcessException) {
      throw new WPSException("Process returned with an exception",exception);
    }
 else {
      throw new WPSException("InternalError: " + exception.getMessage(),exception);
    }
  }
  Map<String,ProcessOutput> outputMap=new HashMap<String,ProcessOutput>();
  if (request.getResponseForm().getRawDataOutput() != null) {
    OutputDefinitionType od=request.getResponseForm().getRawDataOutput();
    String outputName=od.getIdentifier().getValue();
    outputMap.put(outputName,new ProcessOutput(od,result.get(outputName)));
  }
 else {
    for (Iterator it=request.getResponseForm().getResponseDocument().getOutput().iterator(); it.hasNext(); ) {
      OutputDefinitionType od=(OutputDefinitionType)it.next();
      String outputName=od.getIdentifier().getValue();
      outputMap.put(outputName,new ProcessOutput(od,result.get(outputName)));
    }
  }
  return outputMap;
}
