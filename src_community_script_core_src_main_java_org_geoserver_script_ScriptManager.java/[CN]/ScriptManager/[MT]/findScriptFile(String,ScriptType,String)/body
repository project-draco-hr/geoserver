{
  File dir=null;
  if (type == ScriptType.WPS) {
    dir=this.getWpsRoot();
  }
 else   if (type == ScriptType.FUNCTION) {
    dir=this.getFunctionRoot();
  }
 else   if (type == ScriptType.WFSTX) {
    dir=this.getWfsTxRoot();
  }
 else   if (type == ScriptType.APP) {
    dir=this.getAppRoot();
  }
  if (type == ScriptType.APP) {
    File appDir=new File(dir,name);
    appDir.mkdirs();
    return new File(appDir,"main." + extension);
  }
 else {
    return new File(dir,name + "." + extension);
  }
}
