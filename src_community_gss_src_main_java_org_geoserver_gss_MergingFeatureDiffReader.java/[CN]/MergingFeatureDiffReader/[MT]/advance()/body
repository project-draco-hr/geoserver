{
  for (int i=0; i < delegates.length; i++) {
    if (delegates[i] != null && !featureRead[i]) {
      while (delegates[i].hasNext()) {
        FeatureDiff fd=delegates[i].next();
        String fid=fd.getID();
        FeatureDiff[] history;
        if (sortedFids.contains(fid)) {
          history=diffHistory.get(fid);
        }
 else {
          history=new FeatureDiff[delegates.length];
          diffHistory.put(fid,history);
          sortedFids.add(fid);
        }
        history[i]=fd;
        break;
      }
      if (!delegates[i].hasNext()) {
        delegates[i].close();
        delegates[i]=null;
      }
    }
  }
}
