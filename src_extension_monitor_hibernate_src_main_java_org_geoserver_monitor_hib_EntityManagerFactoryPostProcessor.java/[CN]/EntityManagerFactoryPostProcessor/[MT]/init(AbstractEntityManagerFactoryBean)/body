{
  try {
    File f=data.findDataFile("monitoring","hibernate.properties");
    if (f == null) {
      Properties props=new Properties();
      props.putAll(factory.getJpaVendorAdapter().getJpaPropertyMap());
      props.putAll(factory.getJpaPropertyMap());
      File monitoring=data.findOrCreateDataDir("monitoring");
      File file=new File(monitoring,"hibernate.properties");
      FileOutputStream fout=new FileOutputStream(file);
      props.store(fout,"hibernate configuration");
      fout.flush();
      fout.close();
    }
 else {
      Properties props=new Properties();
      FileInputStream fin=new FileInputStream(f);
      props.load(fin);
      fin.close();
      HibernateJpaVendorAdapter adapter=(HibernateJpaVendorAdapter)factory.getJpaVendorAdapter();
      adapter.setDatabase(Database.valueOf((String)props.get("database")));
      adapter.setDatabasePlatform((String)props.get("databasePlatform"));
      adapter.setShowSql(Boolean.valueOf((String)props.getProperty("showSql")));
      adapter.setGenerateDdl(Boolean.valueOf((String)props.getProperty("generateDdl")));
      for (      Map.Entry e : props.entrySet()) {
        if (((String)e.getKey()).startsWith("hibernate")) {
          factory.getJpaPropertyMap().put((String)e.getKey(),e.getValue());
        }
      }
    }
  }
 catch (  IOException e) {
    LOGGER.log(Level.WARNING,e.getLocalizedMessage(),e);
  }
}
