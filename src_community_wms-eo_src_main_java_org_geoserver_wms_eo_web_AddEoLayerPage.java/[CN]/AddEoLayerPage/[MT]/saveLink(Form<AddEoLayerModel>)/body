{
  return new AjaxSubmitLink("save",paramsForm){
    @Override protected void onError(    AjaxRequestTarget target,    Form<?> paramsForm){
      super.onError(target,paramsForm);
      target.addComponent(paramsForm);
    }
    @Override protected void onSubmit(    AjaxRequestTarget target,    Form<?> paramsForm){
      AddEoLayerModel model=(AddEoLayerModel)paramsForm.getModelObject();
      LayerGroupInfo group=model.getGroup();
      EoCatalogBuilder builder=new EoCatalogBuilder(getCatalog());
      if (StringUtils.isEmpty(model.getBitmaskName()) && !StringUtils.isEmpty(model.getBitmaskUrl())) {
        paramsForm.error("Field '" + BITMASK.getObject() + " Name' is required.");
      }
      if (StringUtils.isEmpty(model.getParameterName()) && !StringUtils.isEmpty(model.getParameterUrl())) {
        paramsForm.error("Field '" + GEOPHYSICAL_PARAMETER.getObject() + " Name' is required.");
      }
      if (paramsForm.hasError()) {
        target.addComponent(paramsForm);
      }
 else {
        try {
          group=getCatalog().getLayerGroupByName(group.getWorkspace(),group.getName());
          LayerInfo layer=builder.createEoMasksLayer(group.getWorkspace(),group.getName(),model.getBitmaskName(),model.getBitmaskUrl());
          if (layer != null) {
            group.getLayers().add(layer);
            group.getStyles().add(layer.getDefaultStyle());
          }
          layer=builder.createEoParametersLayer(group.getWorkspace(),group.getName(),model.getParameterName(),model.getParameterUrl());
          if (layer != null) {
            group.getLayers().add(layer);
            group.getStyles().add(layer.getDefaultStyle());
          }
          CatalogBuilder catalogBuilder=new CatalogBuilder(getCatalog());
          catalogBuilder.calculateLayerGroupBounds(group);
          getCatalog().save(group);
          setResponsePage(EoLayerGroupPage.class);
        }
 catch (        RuntimeException e) {
          if (LOGGER.isLoggable(Level.INFO)) {
            LOGGER.log(Level.INFO,e.getMessage(),e);
          }
          paramsForm.error(e.getMessage());
          target.addComponent(paramsForm);
        }
catch (        Exception e) {
          if (LOGGER.isLoggable(Level.INFO)) {
            LOGGER.log(Level.INFO,e.getMessage(),e);
          }
          paramsForm.error(e.getMessage());
          target.addComponent(paramsForm);
        }
      }
    }
  }
;
}
