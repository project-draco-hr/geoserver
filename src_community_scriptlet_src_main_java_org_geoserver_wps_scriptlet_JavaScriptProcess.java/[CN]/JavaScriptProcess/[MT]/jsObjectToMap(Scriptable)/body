{
  Object[] ids=obj.getIds();
  Map<String,Object> map=new HashMap<String,Object>();
  for (  Object idObj : ids) {
    String id=(String)idObj;
    Object value=obj.get(id,obj);
    if (value instanceof Wrapper) {
      map.put(id,((Wrapper)value).unwrap());
    }
 else     if (value instanceof Function) {
    }
 else     if (value instanceof Scriptable) {
      map.put(id,jsObjectToMap((Scriptable)value));
    }
 else {
      map.put(id,value);
    }
  }
  return map;
}
