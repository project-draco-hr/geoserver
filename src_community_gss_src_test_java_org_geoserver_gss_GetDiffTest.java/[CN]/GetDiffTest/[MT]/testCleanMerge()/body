{
  VersioningFeatureStore restricted=(VersioningFeatureStore)synchStore.getFeatureSource("restricted");
  SimpleFeatureType schema=restricted.getSchema();
  Id updateFilter=ff.id(singleton(ff.featureId("restricted.be7cafea-d0b7-4257-9b9c-1ed3de3f7ef4")));
  restricted.modifyFeatures(schema.getDescriptor("cat"),-48,updateFilter);
  Id removeFilter=ff.id(singleton(ff.featureId("restricted.d91fe390-bdc7-4b22-9316-2cd6c8737ef5")));
  restricted.removeFeatures(removeFilter);
  assertEquals(3,restricted.getCount(Query.ALL));
  MockHttpServletResponse response=postAsServletResponse(root(true),loadTextResource("PostDiffInitial.xml"));
  checkPostDiffSuccessResponse(response);
  assertEquals(0,gss.getActiveConflicts("restricted").size());
  response=postAsServletResponse(root(true),loadTextResource("GetDiffInitial.xml"));
  validate(response);
  Document dom=dom(response);
  assertXpathEvaluatesTo("-1","/gss:GetDiffResponse/@fromVersion",dom);
  assertXpathEvaluatesTo("6","/gss:GetDiffResponse/@toVersion",dom);
  assertXpathEvaluatesTo("sf:restricted","/gss:GetDiffResponse/@typeName",dom);
  assertXpathEvaluatesTo("0","count(/gss:GetDiffResponse/gss:Changes/*)",dom);
}
