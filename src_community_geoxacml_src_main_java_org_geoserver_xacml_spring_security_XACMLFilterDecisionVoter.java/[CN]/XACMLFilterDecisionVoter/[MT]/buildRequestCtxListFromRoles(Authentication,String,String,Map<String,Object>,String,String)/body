{
  GeoXACMLConfig.getXACMLRoleAuthority().prepareRoles(auth);
  List<RequestCtx> resultList=new ArrayList<RequestCtx>();
  for (  GrantedAuthority role : auth.getAuthorities()) {
    XACMLRole xacmlRole=(XACMLRole)role;
    if (xacmlRole.isEnabled() == false)     continue;
    RequestCtx requestCtx=GeoXACMLConfig.getRequestCtxBuilderFactory().getURLMatchRequestCtxBuilder(xacmlRole,urlPath,method,httpParams,remoteIP,remoteHost).createRequestCtx();
    resultList.add(requestCtx);
  }
  return resultList;
}
