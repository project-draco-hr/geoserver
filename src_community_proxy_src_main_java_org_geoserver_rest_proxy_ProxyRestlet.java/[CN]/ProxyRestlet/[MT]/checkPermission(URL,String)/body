{
  if (locator.getProtocol().equals("http")) {
    boolean hostnameOk=false, mimetypeOk=false;
    if (config.mode == Mode.HOSTNAME || config.mode == Mode.HOSTNAMEANDMIMETYPE || config.mode == Mode.HOSTNAMEORMIMETYPE) {
      hostnameOk=checkHostnamePermission(locator);
    }
    if (config.mode == Mode.MIMETYPE || config.mode == Mode.HOSTNAMEANDMIMETYPE || config.mode == Mode.HOSTNAMEORMIMETYPE) {
      mimetypeOk=checkContentType(contentType);
    }
switch (config.mode) {
case MIMETYPE:
      return mimetypeOk;
case HOSTNAME:
    return hostnameOk;
case HOSTNAMEANDMIMETYPE:
  return hostnameOk && mimetypeOk;
case HOSTNAMEORMIMETYPE:
return hostnameOk || mimetypeOk;
}
}
return false;
}
