{
  try (Connection c=ds.getConnection()){
    LOGGER.log(Level.FINEST,query.toString());
    PreparedStatement stmt=query.toStatement(c);
    try {
      return stmt.executeUpdate();
    }
  finally {
      stmt.close();
    }
  }
 catch (  SQLException ex) {
    throw new IllegalStateException("UpdateQuery Failed",ex);
  }
}
