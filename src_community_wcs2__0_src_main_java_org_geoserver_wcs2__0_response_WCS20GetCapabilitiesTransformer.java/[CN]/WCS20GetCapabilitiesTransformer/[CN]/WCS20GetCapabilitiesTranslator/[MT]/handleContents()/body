{
  start("wcs:Contents");
  @SuppressWarnings("unchecked") final Set<CoverageInfo> coverages=new TreeSet<CoverageInfo>(new CoverageInfoLabelComparator());
  coverages.addAll(wcs.getGeoServer().getCatalog().getCoverages());
  for (Iterator<CoverageInfo> it=coverages.iterator(); it.hasNext(); ) {
    CoverageInfo cv=(CoverageInfo)it.next();
    if (!cv.enabled()) {
      it.remove();
    }
  }
  for (  CoverageInfo cv : coverages) {
    try {
      mark();
      handleCoverageSummary(cv);
      commit();
    }
 catch (    Exception e) {
      if (skipMisconfigured) {
        reset();
        LOGGER.log(Level.SEVERE,"Skipping coverage " + cv.prefixedName() + " as its capabilities generation failed",e);
      }
 else {
        throw new RuntimeException("Capabilities document generation failed on coverage " + cv.prefixedName(),e);
      }
    }
  }
  end("wcs:Contents");
}
