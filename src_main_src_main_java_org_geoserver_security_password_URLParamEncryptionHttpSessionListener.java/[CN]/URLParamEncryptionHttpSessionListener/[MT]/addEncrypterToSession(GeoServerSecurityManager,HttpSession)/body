{
  char[] key=manager.getRandomPassworddProvider().getRandomPasswordWithDefaultLength();
  StandardPBEByteEncryptor enc=new StandardPBEByteEncryptor();
  enc.setPasswordCharArray(key);
  if (manager.isStrongEncryptionAvailable()) {
    enc.setProvider(new BouncyCastleProvider());
    enc.setAlgorithm("PBEWITHSHA256AND128BITAES-CBC-BC");
  }
 else   enc.setAlgorithm("PBEWITHMD5ANDDES");
  session.setAttribute(SESSION_PARAM_NAME,enc);
  return enc;
}
