{
  WMSMapContent mapContent=createMapContent("EPSG:4326",new Envelope(-92.8,-93.2,4.5,4.6),POINTS,POLYGONS);
  mapContent.setMapHeight(256);
  mapContent.setMapWidth(256);
  MapBoxTileBuilderFactory builderFact=new MapBoxTileBuilderFactory();
  VectorTileMapOutputFormat outputFormat=new VectorTileMapOutputFormat(getWMS(),builderFact);
  outputFormat.setTransformToScreenCoordinates(true);
  RawMap map=(RawMap)outputFormat.produceMap(mapContent);
  ByteArrayOutputStream bos=new ByteArrayOutputStream();
  map.writeTo(bos);
  VectorTileDecoder decoder=new VectorTileDecoder();
  decoder.setAutoScale(false);
  FeatureIterable feats=decoder.decode(bos.toByteArray());
  for (  Feature feat : feats) {
    System.out.println(feat.getLayerName() + ": ");
    System.out.print(feat.getAttributes());
    System.out.println(feat.getGeometry());
  }
  bos.close();
  List<Feature> featList=feats.asList();
  assertEquals(2,featList.size());
  assertEquals("Points",featList.get(0).getLayerName());
  assertTrue(featList.get(0).getGeometry() instanceof Point);
  assertEquals(new Coordinate(641,973),((Point)featList.get(0).getGeometry()).getCoordinate());
  assertEquals("Polygons",featList.get(1).getLayerName());
  assertTrue(featList.get(1).getGeometry() instanceof Polygon);
  assertEquals(new Coordinate(646,976),(((Polygon)featList.get(1).getGeometry()).getCoordinates()[0]));
}
