{
  BufferedImage bi=ImageTypeSpecifier.createGrayscale(nbits,DataBuffer.TYPE_USHORT,false).createBufferedImage(size,size);
  Graphics2D graphics=bi.createGraphics();
  graphics.setColor(Color.BLACK);
  graphics.fillRect(0,0,16,32);
  graphics.setColor(Color.WHITE);
  graphics.fillRect(16,0,16,32);
  graphics.dispose();
  ByteArrayOutputStream bos=new ByteArrayOutputStream();
  new PNGJWriter().writePNG(bi,bos,5,FilterType.FILTER_NONE);
  BufferedImage read=ImageIO.read(new ByteArrayInputStream(bos.toByteArray()));
  ImageAssert.assertImagesEqual(bi,read);
}
