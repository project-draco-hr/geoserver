{
  List<Join> joins=new ArrayList();
  List<Filter> joinFilters=rewriteAndSort(unroll(this.joinFilters),true);
  List<Filter> otherFilters=rewriteAndSort(unroll(this.filters),false);
  for (int i=0; i < featureTypes.size(); i++) {
    Join join=new Join(featureTypes.get(i).getNativeName(),joinFilters.get(i + 1));
    if (aliases != null) {
      join.setAlias(aliases.get(i));
    }
    if (otherFilters.get(i + 1) != null) {
      join.setFilter(otherFilters.get(i + 1));
    }
    joins.add(join);
  }
  return joins;
}
