{
  if (params.containsKey("style")) {
    String style=params.getString("style");
    String[] parts=style.split(":",2);
    if (parts.length == 1) {
      return catalog.getStyleByName(parts[0]);
    }
 else     if (parts.length == 2) {
      return catalog.getStyleByName(parts[0],parts[1]);
    }
 else {
      throw new IllegalStateException("After splitting, there should be only 1 or 2 parts.  Got: " + Arrays.toString(parts));
    }
  }
 else {
    List<LayerInfo> styles=catalog.getLayers(layer);
    if (styles.size() > 0) {
      return styles.get(0).getDefaultStyle();
    }
 else {
      return null;
    }
  }
}
