{
  DataAccessFactory factory=null;
  if (info.getType() != null) {
    factory=DataStoreUtils.aquireFactory(info.getType());
  }
  if (factory == null) {
    factory=DataStoreUtils.aquireFactory(getParams(info.getConnectionParameters(),GeoserverDataDirectory.getGeoserverDataDirectory().getCanonicalPath()));
  }
  return factory;
}
