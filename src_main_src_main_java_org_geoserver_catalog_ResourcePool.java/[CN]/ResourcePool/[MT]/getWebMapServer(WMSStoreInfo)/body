{
  try {
    String id=info.getId();
    WebMapServer wms=(WebMapServer)wmsCache.get(id);
    if (wms == null) {
synchronized (wmsCache) {
        wms=(WebMapServer)wmsCache.get(id);
        if (wms == null) {
          HTTPClient client;
          if (info.isUseConnectionPooling()) {
            client=new MultithreadedHttpClient();
            if (info.getMaxConnections() > 0) {
              int maxConnections=info.getMaxConnections();
              MultithreadedHttpClient mtClient=(MultithreadedHttpClient)client;
              mtClient.setMaxConnections(maxConnections);
            }
          }
 else {
            client=new SimpleHttpClient();
          }
          String username=info.getUsername();
          String password=info.getPassword();
          int connectTimeout=info.getConnectTimeout();
          int readTimeout=info.getReadTimeout();
          client.setUser(username);
          client.setPassword(password);
          client.setConnectTimeout(connectTimeout);
          client.setReadTimeout(readTimeout);
          URL serverURL=new URL(info.getCapabilitiesURL());
          wms=new WebMapServer(serverURL,client);
          wmsCache.put(id,wms);
        }
      }
    }
    return wms;
  }
 catch (  IOException ioe) {
    throw ioe;
  }
catch (  Exception e) {
    throw (IOException)new IOException().initCause(e);
  }
}
