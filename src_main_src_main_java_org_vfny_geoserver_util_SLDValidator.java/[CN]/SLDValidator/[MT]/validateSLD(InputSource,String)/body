{
  SAXParser parser=new SAXParser();
  try {
    String schemaUrl=null;
    if (baseURL != null) {
      String schemaLoction=ResponseUtils.buildSchemaURL(baseURL,"sld/StyledLayerDescriptor.xsd");
      URL schemaFile=new URL(schemaLoction);
      if (LOGGER.isLoggable(Level.INFO)) {
        LOGGER.info(new StringBuffer("Validating SLD with ").append(schemaFile.toString()).toString());
      }
      schemaUrl=schemaFile.toString();
    }
 else {
      File file=GeoServerExtensions.bean(GeoServerResourceLoader.class).find("schemas","sld","StyledLayerDescriptor.xsd");
      if (file == null) {
        throw new RuntimeException("base url not specified and unable to find internal SLD schema");
      }
      schemaUrl=DataUtilities.fileToURL(file).toString();
    }
    parser.setFeature("http://xml.org/sax/features/validation",true);
    parser.setFeature("http://apache.org/xml/features/validation/schema",true);
    parser.setFeature("http://apache.org/xml/features/validation/schema-full-checking",false);
    parser.setProperty("http://apache.org/xml/properties/schema/external-noNamespaceSchemaLocation",schemaUrl);
    parser.setProperty("http://apache.org/xml/properties/schema/external-schemaLocation","http://www.opengis.net/sld " + schemaUrl);
    Validator handler=new Validator();
    parser.setErrorHandler(handler);
    parser.parse(xml);
    return handler.errors;
  }
 catch (  java.io.IOException ioe) {
    ArrayList al=new ArrayList();
    al.add(new SAXParseException(ioe.getLocalizedMessage(),null));
    return al;
  }
catch (  SAXException e) {
    ArrayList al=new ArrayList();
    al.add(new SAXParseException(e.getLocalizedMessage(),null));
    return al;
  }
}
