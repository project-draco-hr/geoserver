{
  ICryptFactory factory=GeoserverWicketEncrypterFactory.get();
  ICrypt crypt=factory.newCrypt();
  String urlParams="search?client=ubuntu&channel=fs&q=spring+protected+constructor&ie=utf-8&oe=utf-8";
  String result=crypt.encryptUrlSafe(urlParams);
  assertFalse(result.equals(urlParams));
  result=crypt.decryptUrlSafe(result);
  assertEquals(urlParams,result);
  GeoserverWicketEncrypterFactory.Factory=null;
  getSecurityManager().getKeyStoreProvider().removeKey(KeyStoreProviderImpl.URLPARAMKEY);
  factory=GeoserverWicketEncrypterFactory.get();
  crypt=factory.newCrypt();
  result=crypt.encryptUrlSafe(urlParams);
  assertTrue(result.equals(urlParams));
  result=crypt.decryptUrlSafe(result);
  assertEquals(urlParams,result);
}
