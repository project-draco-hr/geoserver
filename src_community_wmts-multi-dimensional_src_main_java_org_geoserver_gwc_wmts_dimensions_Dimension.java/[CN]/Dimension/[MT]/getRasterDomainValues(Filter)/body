{
  Tuple<String,StructuredGridCoverage2DReader> rasterReader=getRasterReader();
  GranuleSource source=rasterReader.second.getGranules(rasterReader.first,true);
  List<DimensionDescriptor> descriptors=rasterReader.second.getDimensionDescriptors(rasterReader.first);
  for (  DimensionDescriptor descriptor : descriptors) {
    if (getDimensionName().equalsIgnoreCase(descriptor.getName())) {
      Query query=new Query(source.getSchema().getName().getLocalPart());
      if (filter != null) {
        query.setFilter(filter);
      }
      FeatureCollection featureCollection=source.getGranules(query);
      UniqueVisitor uniqueVisitor=new UniqueVisitor(descriptor.getStartAttribute());
      featureCollection.accepts(uniqueVisitor,null);
      return new TreeSet(uniqueVisitor.getUnique());
    }
  }
  return new TreeSet();
}
