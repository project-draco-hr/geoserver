{
  KMLTransformer transformer=new KMLTransformer(getWMS());
  mapContent.removeLayer(mapContent.layers().get(0));
  mapContent.addLayer(createMapLayer(MockData.BASIC_POLYGONS,"allsymbolizers"));
  mapContent.getViewport().setBounds(new ReferencedEnvelope(-180,0,-90,90,DefaultGeographicCRS.WGS84));
  mapContent.setMapHeight(256);
  mapContent.setMapWidth(256);
  Document document=WMSTestSupport.transform(mapContent,transformer,false);
  assertEquals("kml",document.getDocumentElement().getNodeName());
  assertEquals(3,document.getElementsByTagName("Style").getLength());
  XMLAssert.assertXpathEvaluatesTo("0","count(//Style[1]/IconStyle/Icon/color)",document);
  XMLAssert.assertXpathEvaluatesTo("http://localhost:8080/geoserver/kml/icon/allsymbolizers?0.0.0=","//Style[1]/IconStyle/Icon/href",document);
  XMLAssert.assertXpathEvaluatesTo("b24d4dff","//Style[1]/PolyStyle/color",document);
  XMLAssert.assertXpathEvaluatesTo("1","//Style[1]/PolyStyle/outline",document);
  XMLAssert.assertXpathEvaluatesTo("ffba3e00","//Style[1]/LineStyle/color",document);
}
