{
  String principal=getPreAuthenticatedPrincipalName(request);
  if (principal != null && principal.trim().length() == 0)   principal=null;
  try {
    if (principal != null && RoleSource.UserGroupService.equals(getRoleSource())) {
      GeoServerUserGroupService service=getSecurityManager().loadUserGroupService(getUserGroupServiceName());
      GeoServerUser u=service.getUserByUsername(principal);
      if (u != null && u.isEnabled() == false)       principal=null;
    }
  }
 catch (  IOException ex) {
    throw new RuntimeException(ex);
  }
  return principal;
}
