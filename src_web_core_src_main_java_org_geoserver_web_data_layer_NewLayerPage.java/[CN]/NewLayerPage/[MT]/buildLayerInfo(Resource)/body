{
  Catalog catalog=getCatalog();
  StoreInfo store=catalog.getStore(getSelectedStoreId(),StoreInfo.class);
  try {
    CatalogBuilder builder=new CatalogBuilder(catalog);
    builder.setStore(store);
    if (store instanceof CoverageStoreInfo) {
      CoverageInfo ci=builder.buildCoverage(resource.getName().getLocalPart());
      return builder.buildLayer(ci);
    }
 else     if (store instanceof DataStoreInfo) {
      FeatureTypeInfo fti=builder.buildFeatureType(resource.getName());
      return builder.buildLayer(fti);
    }
 else     if (store instanceof WMSStoreInfo) {
      WMSLayerInfo wli=builder.buildWMSLayer(resource.getLocalName());
      return builder.buildLayer(wli);
    }
  }
 catch (  Exception e) {
    throw new RuntimeException("Error occurred while building the resources for the configuration page",e);
  }
  if (store == null)   throw new IllegalArgumentException("Store is missing from configuration!");
 else   throw new IllegalArgumentException("Don't know how to deal with this store " + store);
}
