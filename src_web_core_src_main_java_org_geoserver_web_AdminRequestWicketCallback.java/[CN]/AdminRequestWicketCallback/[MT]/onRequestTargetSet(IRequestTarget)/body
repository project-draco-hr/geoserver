{
  Class pageClass=null;
  if (requestTarget instanceof PageRequestTarget) {
    pageClass=((PageRequestTarget)requestTarget).getPage().getPageClass();
  }
  if (requestTarget instanceof IBookmarkablePageRequestTarget) {
    pageClass=((IBookmarkablePageRequestTarget)requestTarget).getPageClass();
  }
  if (requestTarget instanceof AjaxRequestTarget) {
    Page p=((AjaxRequestTarget)requestTarget).getPage();
    pageClass=p != null ? p.getClass() : null;
  }
  if (pageClass == null || !(GeoServerSecuredPage.class.isAssignableFrom(pageClass) || GeoServerHomePage.class.isAssignableFrom(pageClass))) {
    AdminRequest.abort();
  }
}
