{
  NetworkLink nl=container.createAndAddNetworkLink();
  nl.setName(layer.getName());
  nl.setOpen(true);
  nl.setVisibility(true);
  if (bounds != null) {
    LookAtDecoratorFactory lookAtFactory=new LookAtDecoratorFactory();
    LookAtOptions lookAtOptions=new LookAtOptions(request.getFormatOptions());
    LookAt la=lookAtFactory.buildLookAt(bounds,lookAtOptions,false);
    nl.setAbstractView(la);
  }
  Region region=nl.createAndSetRegion();
  LatLonAltBox box=region.createAndSetLatLonAltBox();
  box.setNorth(bounds.getMaxY());
  box.setSouth(bounds.getMinY());
  box.setEast(bounds.getMaxX());
  box.setWest(bounds.getMinX());
  Lod lod=region.createAndSetLod();
  lod.setMinLodPixels(128);
  lod.setMaxLodPixels(-1);
  Link link=nl.createAndSetLink();
  String href=WMSRequests.getGetMapUrl(request,layer.getName(),layerIndex,styleName,null,null);
  try {
    href=URLDecoder.decode(href,"UTF-8");
  }
 catch (  UnsupportedEncodingException e) {
    throw new RuntimeException(e);
  }
  link.setHref(href);
}
