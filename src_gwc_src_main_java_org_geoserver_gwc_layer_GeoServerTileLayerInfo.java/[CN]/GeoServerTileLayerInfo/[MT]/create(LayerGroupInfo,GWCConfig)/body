{
  MetadataMap metadataMap=layerInfo.getMetadata();
  GeoServerTileLayerInfo info=create(metadataMap,defaults);
  if (metadataMap.containsKey(CONFIG_KEY_FORMATS)) {
    String mimeFormatsStr=metadataMap.get(CONFIG_KEY_FORMATS,String.class);
    Set<String> mimeFormats=unmarshalSet(mimeFormatsStr);
    info.setMimeFormats(mimeFormats);
  }
 else {
    info.setMimeFormats(defaults.getDefaultOtherCacheFormats());
    info.setDirty(true);
  }
  info.setCachedStyles(Collections.EMPTY_SET);
  return info;
}
