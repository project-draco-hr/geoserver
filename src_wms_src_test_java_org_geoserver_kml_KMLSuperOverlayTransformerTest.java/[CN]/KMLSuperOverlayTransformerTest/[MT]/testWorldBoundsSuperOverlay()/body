{
  KMLSuperOverlayTransformer transformer=new KMLSuperOverlayTransformer(getWMS(),mapContext);
  transformer.setIndentation(2);
  mapContext.setAreaOfInterest(new ReferencedEnvelope(-180,180,-90,90,DefaultGeographicCRS.WGS84));
  ByteArrayOutputStream output=new ByteArrayOutputStream();
  transformer.transform(mapLayer,output);
  DocumentBuilder docBuilder=DocumentBuilderFactory.newInstance().newDocumentBuilder();
  Document document=docBuilder.parse(new ByteArrayInputStream(output.toByteArray()));
  assertEquals("kml",document.getDocumentElement().getNodeName());
  assertEquals(5,document.getElementsByTagName("Region").getLength());
  assertEquals(4,document.getElementsByTagName("NetworkLink").getLength());
  assertEquals(0,document.getElementsByTagName("GroundOverlay").getLength());
}
