{
  return new SubmitLink("save"){
    @Override public void onSubmit(){
      if (lgEntryPanel.getEntries().size() == 0) {
        error((String)new ParamResourceModel("oneLayerMinimum",getPage()).getObject());
        return;
      }
      LayerGroupInfo lg=(LayerGroupInfo)lgModel.getObject();
      if (!LayerGroupInfo.Mode.EO.equals(lg.getMode())) {
        lg.setRootLayer(null);
        lg.setRootLayerStyle(null);
      }
 else {
        if (lg.getRootLayerStyle() == null && lg.getRootLayer() != null) {
          lg.setRootLayerStyle(lg.getRootLayer().getDefaultStyle());
        }
      }
      lg.getLayers().clear();
      lg.getStyles().clear();
      for (      LayerGroupEntry entry : lgEntryPanel.getEntries()) {
        lg.getLayers().add(entry.getLayer());
        lg.getStyles().add(entry.getStyle());
      }
      try {
        AbstractLayerGroupPage.this.save();
      }
 catch (      Exception e) {
        error(e);
        LOGGER.log(Level.WARNING,"Error adding/modifying layer group.",e);
      }
    }
  }
;
}
