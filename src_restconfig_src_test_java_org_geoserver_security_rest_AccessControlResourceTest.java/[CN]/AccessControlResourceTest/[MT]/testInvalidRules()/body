{
  String[][] rules=getDefaultLayerRules();
  String[][] toBeAdded={{"ws.layer1.r.c",TEST_ROLELIST}};
  assertEquals(422,postAsServletResponse(DATA_URI_XML,createXMLBody(toBeAdded),"text/xml").getStatusCode());
  Document dom=getAsDOM(DATA_URI_XML);
  checkXMLResponse(dom,rules);
  toBeAdded=new String[][]{{"ws.layer1.x",TEST_ROLELIST}};
  assertEquals(422,postAsServletResponse(DATA_URI_XML,createXMLBody(toBeAdded),"text/xml").getStatusCode());
  dom=getAsDOM(DATA_URI_XML);
  checkXMLResponse(dom,rules);
  toBeAdded=new String[][]{{"*.layer1.r",TEST_ROLELIST}};
  assertEquals(422,postAsServletResponse(DATA_URI_XML,createXMLBody(toBeAdded),"text/xml").getStatusCode());
  dom=getAsDOM(DATA_URI_XML);
  checkXMLResponse(dom,rules);
  toBeAdded=new String[][]{{"ws.layer1.a",TEST_ROLELIST}};
  assertEquals(422,postAsServletResponse(DATA_URI_XML,createXMLBody(toBeAdded),"text/xml").getStatusCode());
  dom=getAsDOM(DATA_URI_XML);
  checkXMLResponse(dom,rules);
  rules=getDefaultServiceRules();
  toBeAdded=new String[][]{{"ws.getMap.c",TEST_ROLELIST}};
  assertEquals(422,postAsServletResponse(SERVICE_URI_XML,createXMLBody(toBeAdded),"text/xml").getStatusCode());
  dom=getAsDOM(SERVICE_URI_XML);
  checkXMLResponse(dom,rules);
  toBeAdded=new String[][]{{"*.getMap",TEST_ROLELIST}};
  assertEquals(422,postAsServletResponse(SERVICE_URI_XML,createXMLBody(toBeAdded),"text/xml").getStatusCode());
  dom=getAsDOM(SERVICE_URI_XML);
  checkXMLResponse(dom,rules);
  rules=getDefaultRestRules();
  toBeAdded=new String[][]{rules[0],{"/myworkspace/**!!!GET",TEST_ROLELIST}};
  assertEquals(422,postAsServletResponse(REST_URI_XML,createXMLBody(toBeAdded),"text/xml").getStatusCode());
  dom=getAsDOM(REST_URI_XML);
  checkXMLResponse(dom,rules);
}
