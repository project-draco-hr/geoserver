{
  DataAccessRuleDAO dao=GeoServerExtensions.bean(DataAccessRuleDAO.class,applicationContext);
  dao.setCatalogMode(CatalogMode.CHALLENGE);
  authenticate(username,password);
  Document doc=getAsDOM("wfs?request=GetFeature&version=1.0.0&service=wfs&typeName=" + getLayerId(MockData.BUILDINGS));
  assertXpathEvaluatesTo("1","count(/wfs:FeatureCollection)",doc);
}
