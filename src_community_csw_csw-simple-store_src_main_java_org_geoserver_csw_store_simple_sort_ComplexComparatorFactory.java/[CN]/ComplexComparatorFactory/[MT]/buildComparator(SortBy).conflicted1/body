{
  if (sortBy == null) {
    throw new NullPointerException("The sortBy argument must be not null");
  }
  if (sortBy == SortBy.NATURAL_ORDER) {
    return new FidComparator(true);
  }
 else   if (sortBy == SortBy.REVERSE_ORDER) {
    return new FidComparator(false);
  }
 else {
    return new PropertyComparator(sortBy.getPropertyName(),sortBy.getSortOrder() == SortOrder.ASCENDING);
  }
}
