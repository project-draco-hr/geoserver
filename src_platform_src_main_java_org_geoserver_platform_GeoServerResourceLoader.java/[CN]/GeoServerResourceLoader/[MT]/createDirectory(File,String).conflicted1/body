{
  File file=find(parent,location);
  if (file != null) {
    if (!file.isDirectory()) {
      String msg=location + " already exists and is not directory";
      throw new IOException(msg);
    }
  }
  file=parent != null ? new File(parent,location) : new File(location);
  if (file.isAbsolute()) {
    file.mkdirs();
    return file;
  }
  if (baseDirectory == null) {
    String msg="No base location set, could not create directory: " + location;
    throw new IOException(msg);
  }
  if (parent != null && parent.getPath().startsWith(baseDirectory.getPath())) {
    file=new File(parent,location);
  }
 else {
    file=parent != null ? new File(new File(baseDirectory,parent.getPath()),location) : new File(baseDirectory,location);
  }
  file.mkdirs();
  return file;
}
