{
  if (group == null)   return null;
  WrapperPolicy policy=buildWrapperPolicy(user,group,group.getName());
  if (policy.level == AccessLevel.HIDDEN) {
    return null;
  }
  final List<LayerInfo> layers=group.getLayers();
  ArrayList<LayerInfo> wrapped=new ArrayList<LayerInfo>(layers.size());
  boolean needsWrapping=false;
  for (  LayerInfo layer : layers) {
    LayerInfo checked=checkAccess(user,layer);
    if (checked == null)     return null;
 else     if (checked != null && checked != layer)     needsWrapping=true;
    wrapped.add(checked);
  }
  if (needsWrapping)   return new SecuredLayerGroupInfo(group,wrapped);
 else   return group;
}
