{
synchronized (style) {
    GetLegendGraphicOutputFormat pngOutputFormat=new PNGLegendOutputFormat();
    Resource sampleLegend=getStyleResource(style,FileType.SAMPLE);
    if (sampleLegend.getType() == Resource.Type.RESOURCE && !isStyleSampleInvalid(style)) {
      return getSizeFromSample(sampleLegend);
    }
 else {
      return createNewSample(style,pngOutputFormat,sampleLegend);
    }
  }
}
