{
  setDefaultModel(new CompoundPropertyModel(new ServiceAccessRule(rule)));
  form=new Form("ruleForm");
  add(form);
  form.add(service=new DropDownChoice("service",getServiceNames()));
  service.add(new AjaxFormComponentUpdatingBehavior("onchange"){
    @Override protected void onUpdate(    AjaxRequestTarget target){
      method.setChoices(new Model(getMethod((String)service.getConvertedInput())));
      method.modelChanged();
      target.addComponent(method);
    }
  }
);
  setOutputMarkupId(true);
  form.add(method=new DropDownChoice("method",getMethod(rule.getService())));
  method.setOutputMarkupId(true);
  form.add(rolesForComponent=new RolesFormComponent("roles",new RolesModel(rule),form,true));
  form.add(new BookmarkablePageLink("cancel",ServiceAccessRulePage.class));
  form.add(saveLink());
  service.setRequired(true);
  method.setRequired(true);
}
