{
  Set<Subject> subjects=new HashSet<Subject>(1);
  addRole(subjects);
  Set<Attribute> resources=new HashSet<Attribute>(1);
  addGeoserverResource(resources);
  addResource(resources,XACMLConstants.RoleEnablemetnResourceURI,targetRole.getAuthority());
  Set<Attribute> actions=new HashSet<Attribute>(1);
  addAction(actions);
  Set<Attribute> environment=new HashSet<Attribute>(1);
  if (userName != null) {
    environment.add(new Attribute(XACMLConstants.UserEnvironmentURI,null,null,new StringAttribute(userName)));
  }
  RequestCtx ctx=new RequestCtx(subjects,resources,actions,environment);
  return ctx;
}
