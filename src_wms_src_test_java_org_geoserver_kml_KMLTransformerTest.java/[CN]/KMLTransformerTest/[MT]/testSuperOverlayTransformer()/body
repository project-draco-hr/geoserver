{
  KMLSuperOverlayTransformer transformer=new KMLSuperOverlayTransformer(getWMS(),mapContent);
  transformer.setIndentation(2);
  mapContent.getViewport().setBounds(new ReferencedEnvelope(-180.0,180.0,-90.0,90.0,DefaultGeographicCRS.WGS84));
  ByteArrayOutputStream output=new ByteArrayOutputStream();
  transformer.transform(layer,output);
  DocumentBuilder docBuilder=DocumentBuilderFactory.newInstance().newDocumentBuilder();
  Document document=docBuilder.parse(new ByteArrayInputStream(output.toByteArray()));
  assertEquals("kml",document.getDocumentElement().getNodeName());
  assertEquals(5,document.getElementsByTagName("Region").getLength());
  assertEquals(4,document.getElementsByTagName("NetworkLink").getLength());
}
