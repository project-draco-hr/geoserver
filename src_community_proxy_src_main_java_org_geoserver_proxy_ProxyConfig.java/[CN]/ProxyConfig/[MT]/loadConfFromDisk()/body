{
  ProxyConfig retval;
  Resource.Lock lock=null;
  try {
    GeoServerResourceLoader loader=GeoServerExtensions.bean(GeoServerResourceLoader.class);
    Resource configFile=loader.get("proxy/proxy.xml");
    lock=configFile.lock();
    InputStream proxyConfStream=configFile.in();
    XStream xs=new SecureXStream();
    xs.allowTypes(new Class[]{ProxyConfig.class,ProxyConfig.Mode.class});
    retval=(ProxyConfig)(xs.fromXML(proxyConfStream));
  }
 catch (  Exception e) {
    LOG.warning("Failed to open configuration for Proxy module. Using default. Exception:" + e.toString());
    retval=DEFAULT;
  }
 finally {
    if (lock != null)     lock.release();
  }
  return retval;
}
