{
  Catalog catalog=getCatalog();
  StyleInfo s=(StyleInfo)styleForm.getModelObject();
  try {
    Version version=Styles.findVersion(new ByteArrayInputStream(rawSLD.getBytes()));
    s.setSLDVersion(version);
    if (s.getFilename() == null) {
      s.setFilename(s.getName() + ".sld");
    }
    getCatalog().add(s);
  }
 catch (  Exception e) {
    LOGGER.log(Level.SEVERE,"Error occurred saving the style",e);
    error(e);
    return;
  }
  try {
    catalog.getResourcePool().writeStyle(s,new ByteArrayInputStream(rawSLD.getBytes()));
  }
 catch (  IOException e) {
    throw new WicketRuntimeException(e);
  }
  setResponsePage(StylePage.class);
}
