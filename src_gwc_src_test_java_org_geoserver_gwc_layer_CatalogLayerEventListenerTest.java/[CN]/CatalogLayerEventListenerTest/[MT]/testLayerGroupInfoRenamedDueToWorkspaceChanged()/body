{
  WorkspaceInfo workspace=mock(WorkspaceInfo.class);
  when(workspace.getName()).thenReturn("mockWs");
  CatalogModifyEvent modifyEvent=mock(CatalogModifyEvent.class);
  when(modifyEvent.getSource()).thenReturn(mockLayerGroupInfo);
  when(modifyEvent.getPropertyNames()).thenReturn(Arrays.asList("workspace"));
  when(modifyEvent.getOldValues()).thenReturn(Arrays.asList((Object)null));
  when(modifyEvent.getNewValues()).thenReturn(Arrays.asList((Object)workspace));
  GeoServerTileLayerInfo info=TileLayerInfoUtil.loadOrCreate(mockLayerGroupInfo,GWCConfig.getOldDefaults());
  GeoServerTileLayer tileLayer=mock(GeoServerTileLayer.class);
  when(tileLayer.getInfo()).thenReturn(info);
  when(tileLayer.getLayerGroupInfo()).thenReturn(mockLayerGroupInfo);
  when(mockMediator.hasTileLayer(same(mockLayerGroupInfo))).thenReturn(true);
  when(mockMediator.getTileLayer(same(mockLayerGroupInfo))).thenReturn(tileLayer);
  final String oldLayerName=tileLayerName(mockLayerGroupInfo);
  when(mockMediator.getTileLayerByName(eq(oldLayerName))).thenReturn(tileLayer);
  listener.handleModifyEvent(modifyEvent);
  verify(mockMediator,times(1)).hasTileLayer(same(mockLayerGroupInfo));
  verify(mockMediator,times(1)).getTileLayer(same(mockLayerGroupInfo));
  CatalogPostModifyEvent postModifyEvent=mock(CatalogPostModifyEvent.class);
  when(postModifyEvent.getSource()).thenReturn(mockLayerGroupInfo);
  when(mockLayerGroupInfo.getWorkspace()).thenReturn(workspace);
  String prefixedName=workspace.getName() + ":" + mockLayerGroupInfo.getName();
  when(mockLayerGroupInfo.prefixedName()).thenReturn(prefixedName);
  listener.handlePostModifyEvent(postModifyEvent);
  ArgumentCaptor<GeoServerTileLayer> captor=ArgumentCaptor.forClass(GeoServerTileLayer.class);
  verify(mockMediator).save(captor.capture());
  GeoServerTileLayer saved=captor.getValue();
  assertNotNull(saved);
  assertNotNull(saved.getInfo());
  GeoServerTileLayerInfo savedInfo=saved.getInfo();
  assertSame(info,savedInfo);
  String tileLayerName=tileLayerName(mockLayerGroupInfo);
  String actual=savedInfo.getName();
  assertEquals(tileLayerName,actual);
}
