{
  String proxyBaseUrl=geoServer.getGlobal().getProxyBaseUrl();
  if (proxyBaseUrl != null) {
    try {
      URI proxyBaseUri=URI.createURI(proxyBaseUrl);
      if (uri.host().equals(proxyBaseUri.host())) {
        return true;
      }
    }
 catch (    IllegalArgumentException e) {
      LOGGER.fine("Unable to parse proxy base url to a uri: " + proxyBaseUrl);
    }
  }
  for (  InetAddress add : ADDRESSES) {
    if (uri.host().equals(add.getHostAddress()) || uri.host().equals(add.getHostName())) {
      return true;
    }
  }
  return false;
}
