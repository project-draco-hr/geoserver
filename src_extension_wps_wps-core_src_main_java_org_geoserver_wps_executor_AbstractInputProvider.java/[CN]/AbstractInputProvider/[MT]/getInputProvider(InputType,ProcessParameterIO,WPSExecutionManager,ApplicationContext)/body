{
  if (input.getReference() != null) {
    InputReferenceType ref=input.getReference();
    String href=ref.getHref();
    if (href.startsWith("http://geoserver/wfs")) {
      return new InternalWFSInputProvider(input,ppio,context);
    }
 else     if (href.startsWith("http://geoserver/wcs")) {
      return new InternalWCSInputProvider(input,ppio,context);
    }
 else     if (href.startsWith("http://geoserver/wps")) {
      return new InternalWPSInputProvider(input,ppio,executor,context);
    }
 else {
      return new RemoteRequestInputProvider(input,(ComplexPPIO)ppio,executor.getConnectionTimeout());
    }
  }
 else {
    return new SimpleInputProvider(input,ppio);
  }
}
