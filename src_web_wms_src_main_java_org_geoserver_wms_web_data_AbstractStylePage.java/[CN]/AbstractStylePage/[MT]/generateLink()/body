{
  return new AjaxSubmitLink("generate"){
    @Override protected void onSubmit(    AjaxRequestTarget target,    Form form){
      templates.processInput();
      StyleType template=(StyleType)templates.getConvertedInput();
      StyleGenerator styleGen=new StyleGenerator(getCatalog());
      styleGen.setWorkspace(wsChoice.getModel().getObject());
      if (template != null) {
        try {
          editor.reset();
          setRawStyle(new StringReader(styleGen.generateStyle(styleHandler(),template,nameTextField.getInput())));
          target.appendJavaScript(String.format("if (document.gsEditors) { document.gsEditors.editor.setOption('mode', '%s'); }",styleHandler().getCodeMirrorEditMode()));
        }
 catch (        Exception e) {
          error("Errors occurred generating the style");
        }
        target.add(styleForm);
      }
    }
    @Override protected void updateAjaxAttributes(    AjaxRequestAttributes attributes){
      super.updateAjaxAttributes(attributes);
      attributes.getAjaxCallListeners().add(new AjaxCallListener(){
        @Override public CharSequence getPrecondition(        Component component){
          CharSequence message=new ParamResourceModel("confirmOverwrite",AbstractStylePage.this).getString();
          message=JavaScriptUtils.escapeQuotes(message);
          return "var val = attrs.event.view.document.gsEditors ? " + "attrs.event.view.document.gsEditors." + editor.getTextAreaMarkupId() + ".getValue() : "+ "attrs.event.view.document.getElementById(\""+ editor.getTextAreaMarkupId()+ "\").value; "+ "if(val != '' &&"+ "!confirm('"+ message+ "')) return false;";
        }
      }
);
    }
    @Override public boolean getDefaultFormProcessing(){
      return false;
    }
  }
;
}
