{
  File temp=new File(f.getParentFile(),f.getName() + ".tmp");
  if (temp.exists()) {
    temp.delete();
  }
  BufferedOutputStream out=null;
  try {
    out=new BufferedOutputStream(new FileOutputStream(temp));
    xp.save(obj,out);
    out.flush();
  }
  finally {
    if (out != null)     org.apache.commons.io.IOUtils.closeQuietly(out);
  }
  rename(temp,f);
}
