{
  Map<String,Object> attributes=request.getAttributes();
  String workspace=(String)attributes.get("workspace");
  String styleName=(String)attributes.get("style");
  StyleInfo styleInfo=catalog.getStyleByName(workspace,styleName);
  try {
    Style style=styleInfo.getStyle();
    Map<String,String> properties=asSimpleMap(request.getResourceRef().getQueryAsForm());
    Style adjustedStyle=IconPropertyInjector.injectProperties(style,properties);
    Resource resource=new Resource(getContext(),request,response);
    resource.getVariants().add(new IconEntity(adjustedStyle));
    return resource;
  }
 catch (  IOException e) {
    throw new RestletException("Failed to load style: " + workspace + " "+ styleName,Status.SERVER_ERROR_INTERNAL,e);
  }
}
