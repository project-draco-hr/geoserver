{
  initializeForXML();
  activatePanel();
  assertEquals(2,countItmes());
  assertNotNull(getSecurityNamedServiceConfig("default"));
  assertNotNull(getSecurityNamedServiceConfig("test"));
  assertNull(getSecurityNamedServiceConfig("xxxxxxxx"));
  clickAddNew();
  tester.assertRenderedPage(SecurityNamedServiceNewPage.class);
  newFormTester();
  setSecurityConfigClassName(XMLRoleServicePanelInfo.class);
  newFormTester();
  setSecurityConfigName("default2");
  setFileName("abc.xml");
  setCheckInterval(5000);
  setValidating(true);
  clickCancel();
  tester.assertRenderedPage(basePage.getClass());
  assertEquals(2,countItmes());
  assertNotNull(getSecurityNamedServiceConfig("default"));
  clickAddNew();
  newFormTester();
  setSecurityConfigClassName(XMLRoleServicePanelInfo.class);
  newFormTester();
  setSecurityConfigName("default2");
  setFileName("abc.xml");
  setCheckInterval(5000);
  setValidating(true);
  tester.assertRenderedPage(SecurityNamedServiceNewPage.class);
  clickSave();
  tester.assertRenderedPage(basePage.getClass());
  assertEquals(3,countItmes());
  assertNotNull(getSecurityNamedServiceConfig("default"));
  XMLRoleServiceConfig xmlConfig=(XMLRoleServiceConfig)getSecurityNamedServiceConfig("default2");
  assertNotNull(xmlConfig);
  assertEquals("default2",xmlConfig.getName());
  assertEquals(XMLRoleService.class.getName(),xmlConfig.getClassName());
  assertNull(xmlConfig.getAdminRoleName());
  assertEquals("abc.xml",xmlConfig.getFileName());
  assertEquals(5000,xmlConfig.getCheckInterval());
  assertEquals(true,xmlConfig.isValidating());
  xmlConfig=(XMLRoleServiceConfig)getSecurityManager().loadRoleServiceConfig("default2");
  assertNotNull(xmlConfig);
  assertEquals("default2",xmlConfig.getName());
  assertEquals(XMLRoleService.class.getName(),xmlConfig.getClassName());
  assertNull(xmlConfig.getAdminRoleName());
  assertEquals("abc.xml",xmlConfig.getFileName());
  assertEquals(5000,xmlConfig.getCheckInterval());
  assertEquals(true,xmlConfig.isValidating());
  clickAddNew();
  newFormTester();
  setSecurityConfigClassName(XMLRoleServicePanelInfo.class);
  newFormTester();
  setSecurityConfigName("default2");
  clickSave();
  tester.assertRenderedPage(SecurityNamedServiceNewPage.class);
  testErrorMessagesWithRegExp(".*default2.*");
  clickCancel();
  tester.assertRenderedPage(basePage.getClass());
  clickNamedServiceConfig("default");
  tester.assertRenderedPage(SecurityNamedServiceEditPage.class);
  newFormTester("panel:panel:panel:form");
  tester.debugComponentTrees();
  formTester.setValue("panel:adminRoleName","ROLE_ADMINISTRATOR");
  formTester.setValue("panel:checkInterval","5001");
  formTester.setValue("panel:validating",true);
  clickCancel();
  tester.assertRenderedPage(basePage.getClass());
  xmlConfig=(XMLRoleServiceConfig)getSecurityNamedServiceConfig("default");
  assertEquals("ROLE_ADMINISTRATOR",xmlConfig.getAdminRoleName());
  assertEquals("roles.xml",xmlConfig.getFileName());
  assertEquals(10000,xmlConfig.getCheckInterval());
  assertEquals(true,xmlConfig.isValidating());
  clickNamedServiceConfig("default2");
  newFormTester("panel:panel:panel:form");
  formTester.setValue("panel:adminRoleName",null);
  formTester.setValue("panel:checkInterval","5001");
  formTester.setValue("panel:validating",false);
  clickSave();
  tester.assertRenderedPage(basePage.getClass());
  xmlConfig=(XMLRoleServiceConfig)getSecurityNamedServiceConfig("default2");
  assertNull(xmlConfig.getAdminRoleName());
  assertEquals("abc.xml",xmlConfig.getFileName());
  assertEquals(5001,xmlConfig.getCheckInterval());
  assertEquals(false,xmlConfig.isValidating());
  xmlConfig=(XMLRoleServiceConfig)getSecurityManager().loadRoleServiceConfig("default2");
  assertNull(xmlConfig.getAdminRoleName());
  assertEquals("abc.xml",xmlConfig.getFileName());
  assertEquals(5001,xmlConfig.getCheckInterval());
  assertEquals(false,xmlConfig.isValidating());
}
