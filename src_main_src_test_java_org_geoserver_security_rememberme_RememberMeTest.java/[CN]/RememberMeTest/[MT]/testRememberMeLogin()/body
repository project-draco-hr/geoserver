{
  MockHttpServletRequest request=createRequest("/j_spring_security_check");
  request.setupAddParameter("username","admin");
  request.setupAddParameter("password","geoserver");
  request.setMethod("POST");
  MockHttpServletResponse response=dispatch(request);
  assertLoginOk(response);
  assertEquals(0,response.getCookies().size());
  request=createRequest("/j_spring_security_check");
  request.setupAddParameter("username","admin");
  request.setupAddParameter("password","geoserver");
  request.setupAddParameter("_spring_security_remember_me","yes");
  request.setMethod("POST");
  response=dispatch(request);
  assertLoginOk(response);
  assertEquals(1,response.getCookies().size());
  Cookie cookie=(Cookie)response.getCookies().get(0);
  request=createRequest("/web/");
  response=dispatch(request);
  assertNull(request.getAttribute("auth"));
  request=createRequest("/web/");
  request.addCookie(cookie);
  response=dispatch(request);
  assertTrue(request.getAttribute("auth") instanceof RememberMeAuthenticationToken);
}
