{
  super(id);
  items=new ArrayList<LayerGroupEntry>();
  for (int i=0; i < layerGroup.getLayers().size(); i++) {
    PublishedInfo layer=layerGroup.getLayers().get(i);
    if (layer instanceof LayerInfo) {
      String type=(String)layer.getMetadata().get(EoLayerType.KEY);
      if (EoLayerType.BAND_COVERAGE.name().equals(type) || EoLayerType.COVERAGE_OUTLINE.name().equals(type)) {
        continue;
      }
    }
    StyleInfo style=layerGroup.getStyles().get(i);
    items.add(new LayerGroupEntry(layer,style));
  }
  add(popupWindow=new ModalWindow("popup"));
  entryProvider=new LayerGroupEntryProvider(items);
  add(layerTable=new GeoServerTablePanel<LayerGroupEntry>("layers",entryProvider){
    @Override protected Component getComponentForProperty(    String id,    IModel itemModel,    Property<LayerGroupEntry> property){
      if (property == LayerGroupEntryProvider.LAYER) {
        return layerLink(id,itemModel);
      }
      if (property == LayerGroupEntryProvider.DEFAULT_STYLE) {
        return defaultStyleCheckbox(id,itemModel);
      }
      if (property == LayerGroupEntryProvider.STYLE) {
        return styleLink(id,itemModel);
      }
      if (property == LayerGroupEntryProvider.REMOVE) {
        return removeLink(id,itemModel);
      }
      if (property == LayerGroupEntryProvider.POSITION) {
        return positionPanel(id,itemModel);
      }
      return null;
    }
  }
.setFilterable(false));
  layerTable.setOutputMarkupId(true);
  final Panel addLayerPanel=new AddEoLayerPanel(popupWindow.getContentId(),layerGroup){
    @Override protected void onCancel(    AjaxRequestTarget target){
      popupWindow.close(target);
    }
    @Override protected void onSubmit(    AjaxRequestTarget target,    LayerInfo maskLayer,    LayerInfo paramsLayer){
      if (maskLayer != null) {
        entryProvider.getItems().add(new LayerGroupEntry(maskLayer,maskLayer.getDefaultStyle()));
      }
      if (paramsLayer != null) {
        entryProvider.getItems().add(new LayerGroupEntry(paramsLayer,paramsLayer.getDefaultStyle()));
      }
      target.addComponent(layerTable);
      popupWindow.close(target);
    }
  }
;
  add(new AjaxLink("addLayer"){
    @Override public void onClick(    AjaxRequestTarget target){
      popupWindow.setInitialHeight(375);
      popupWindow.setInitialWidth(525);
      popupWindow.setTitle(new ParamResourceModel("chooseLayer",this));
      popupWindow.setContent(addLayerPanel);
      popupWindow.show(target);
    }
  }
);
}
