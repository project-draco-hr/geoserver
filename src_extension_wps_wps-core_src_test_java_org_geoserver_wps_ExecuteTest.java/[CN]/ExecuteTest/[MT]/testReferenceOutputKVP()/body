{
  String request="wps?service=WPS&version=1.0.0&request=Execute&Identifier=gs:BufferFeatureCollection" + "&DataInputs=" + urlEncode("feature collection=" + readFileIntoString("states-FeatureCollection.xml") + "@mimetype=application/wfs-collection-1.1;width of the buffer=10") + "&ResponseDocument="+ urlEncode("result=@asReference=true");
  Document d=getAsDOM(request);
  checkValidationErrors(d);
  assertEquals("wps:ExecuteResponse",d.getDocumentElement().getNodeName());
  assertXpathExists("/wps:ExecuteResponse/wps:Status/wps:ProcessSucceeded",d);
  assertXpathExists("/wps:ExecuteResponse/wps:ProcessOutputs/wps:Output/wps:Reference",d);
  XpathEngine xpath=XMLUnit.newXpathEngine();
  String fullLocation=xpath.evaluate("/wps:ExecuteResponse/wps:ProcessOutputs/wps:Output/wps:Reference/@href",d);
  String resourceLocation=fullLocation.substring(fullLocation.indexOf('?') - 3);
  d=getAsDOM(resourceLocation);
  assertXpathExists("wfs:FeatureCollection",d);
}
