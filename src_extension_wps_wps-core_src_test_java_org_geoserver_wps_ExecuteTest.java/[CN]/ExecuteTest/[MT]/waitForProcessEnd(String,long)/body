{
  XpathEngine xpath=XMLUnit.newXpathEngine();
  Document dom=null;
  long start=System.currentTimeMillis();
  while (((System.currentTimeMillis() - start) / 1000 < maxWaitSeconds)) {
    dom=getAsDOM(statusLocation);
    if (xpath.getMatchingNodes("//wps:Status/ProcessAccepted",dom).getLength() > 0 || xpath.getMatchingNodes("//wps:Status/ProcessStarted",dom).getLength() > 0 || xpath.getMatchingNodes("//wps:Status/ProcessQueued",dom).getLength() > 0) {
      Thread.sleep(100);
    }
 else {
      return dom;
    }
  }
  throw new Exception("Waited for the process to complete more than " + maxWaitSeconds);
}
