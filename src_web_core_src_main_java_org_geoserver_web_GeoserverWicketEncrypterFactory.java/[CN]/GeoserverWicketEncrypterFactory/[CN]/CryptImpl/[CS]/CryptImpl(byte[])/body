{
  enc=new StandardPBEByteEncryptor();
  enc.setPasswordCharArray(SecurityUtils.toChars(password));
  if (GeoServerApplication.get().getSecurityManager().isStrongEncryptionAvailable()) {
    enc.setProvider(new BouncyCastleProvider());
    enc.setAlgorithm("PBEWITHSHA256AND128BITAES-CBC-BC");
  }
 else   enc.setAlgorithm("PBEWITHMD5ANDDES");
}
