{
  if (transportFactory != null)   return transportFactory;
synchronized (transportFactoryLock) {
    if (transportFactory != null)     return transportFactory;
    transportFactory=GeoServerExtensions.bean(XACMLTransportFactory.class);
    if (transportFactory == null)     transportFactory=new XACMLLocalTransportFactory(getPDP(),true);
    return transportFactory;
  }
}
