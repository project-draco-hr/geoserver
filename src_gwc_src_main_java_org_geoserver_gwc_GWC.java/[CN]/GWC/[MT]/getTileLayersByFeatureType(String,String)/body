{
  NamespaceInfo namespace;
  if (namespaceURI == null || XMLConstants.DEFAULT_NS_PREFIX.equals(namespaceURI)) {
    namespace=getCatalog().getDefaultNamespace();
  }
 else {
    namespace=getCatalog().getNamespaceByURI(namespaceURI);
  }
  final FeatureTypeInfo typeInfo=getCatalog().getFeatureTypeByName(namespace,typeName);
  final List<LayerInfo> layers=getCatalog().getLayers(typeInfo);
  Set<String> affectedLayers=new HashSet<String>();
  for (  LayerInfo layer : layers) {
    final String tileLayerName=tileLayerName(layer);
    if (tileLayerExists(tileLayerName)) {
      affectedLayers.add(tileLayerName);
    }
  }
  for (  LayerGroupInfo lgi : getLayerGroups()) {
    final String tileLayerName=tileLayerName(lgi);
    if (!tileLayerExists(tileLayerName)) {
      continue;
    }
    for (    LayerInfo li : lgi.layers()) {
      ResourceInfo resource=li.getResource();
      if (typeInfo.equals(resource)) {
        affectedLayers.add(tileLayerName);
      }
    }
  }
  return affectedLayers;
}
