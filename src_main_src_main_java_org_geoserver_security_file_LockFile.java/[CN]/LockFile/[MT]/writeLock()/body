{
  if (hasWriteLock())   return;
  if (lockFile.exists()) {
    LOGGER.warning("Cannot obtain  lock: " + lockFile.getCanonicalPath());
    Properties props=new Properties();
    try (FileInputStream in=new FileInputStream(lockFile)){
      props.load(in);
    }
     throw new IOException(Util.convertPropsToString(props,"Already locked"));
  }
 else {
    writeLockFileContent(lockFile);
    lockFileLastModified=lockFile.lastModified();
    lockFile.deleteOnExit();
    LOGGER.info("Successful lock: " + lockFile.getCanonicalPath());
  }
}
