{
  LoggingInitializer.LOGGER.fine("CONFIGURING GEOSERVER LOGGING -------------------------");
  if (configFileName == null) {
    configFileName="DEFAULT_LOGGING.properties";
    LoggingInitializer.LOGGER.warning("No log4jConfigFile defined in services.xml:  using 'DEFAULT_LOGGING.properties'");
  }
  File log4jConfigFile=resourceLoader.find("logs",configFileName);
  if (log4jConfigFile == null) {
    LoggingInitializer.LOGGER.warning("log4jConfigFile '" + configFileName + "' couldn't be found in the data dir, so GeoServer will "+ "install the various logging config file into the data dir, and then try to find it again.");
    File lcdir=resourceLoader.findOrCreateDirectory("logs");
    final String[] lcfiles=new String[]{"DEFAULT_LOGGING.properties","VERBOSE_LOGGING.properties","PRODUCTION_LOGGING.properties","GEOTOOLS_DEVELOPER_LOGGING.properties","GEOSERVER_DEVELOPER_LOGGING.properties"};
    for (int i=0; i < lcfiles.length; i++) {
      File target=new File(lcdir.getAbsolutePath(),lcfiles[i]);
      if (!target.exists()) {
        resourceLoader.copyFromClassPath(lcfiles[i],target);
      }
    }
    log4jConfigFile=resourceLoader.find("logs",configFileName);
    if (log4jConfigFile == null) {
      LoggingInitializer.LOGGER.warning("Still couldn't find log4jConfigFile '" + configFileName + "'.  Using DEFAULT_LOGGING.properties instead.");
    }
    log4jConfigFile=resourceLoader.find("logs","DEFAULT_LOGGING.properties");
  }
  if (log4jConfigFile == null || !log4jConfigFile.exists()) {
    throw new ConfigurationException("Unable to load logging configuration '" + configFileName + "'.  In addition, an attempt "+ "was made to create the 'logs' directory in your data dir, and to use the DEFAULT_LOGGING configuration, but"+ "this failed as well.  Is your data dir writeable?");
  }
  InputStream loggingConfigStream=new FileInputStream(log4jConfigFile);
  if (loggingConfigStream == null) {
    LoggingInitializer.LOGGER.warning("Couldn't open Log4J configuration file '" + log4jConfigFile.getAbsolutePath());
    return;
  }
 else {
    LoggingInitializer.LOGGER.fine("GeoServer logging profile '" + log4jConfigFile.getName() + "' enabled.");
  }
  configureGeoServerLogging(resourceLoader,loggingConfigStream,suppressStdOutLogging,false,logFileName);
}
