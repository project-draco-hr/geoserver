{
  final ScaleAxisByFactorType scaleType=scaling.getScaleAxesByFactor();
  final EList<ScaleAxisType> targetAxisScaleElements=scaleType.getScaleAxis();
  ScaleAxisType xScale=null, yScale=null;
  for (  ScaleAxisType scaleAxisType : targetAxisScaleElements) {
    final String axisName=scaleAxisType.getAxis();
    if (axisName.equals("http://www.opengis.net/def/axis/OGC/1/i")) {
      xScale=scaleAxisType;
    }
 else     if (axisName.equals("http://www.opengis.net/def/axis/OGC/1/j")) {
      yScale=scaleAxisType;
    }
 else {
      throw new WCS20Exception("Scale Axis Undefined",WCS20Exception.WCS20ExceptionCode.ScaleAxisUndefined,axisName);
    }
  }
  if (xScale == null) {
    throw new WCS20Exception("Missing scale factor along i",WCS20Exception.WCS20ExceptionCode.InvalidScaleFactor,"");
  }
  if (yScale == null) {
    throw new WCS20Exception("Missing scale factor along j",WCS20Exception.WCS20ExceptionCode.InvalidScaleFactor,"");
  }
  final double scaleFactorX=xScale.getScaleFactor();
  if (scaleFactorX < 0) {
    throw new WCS20Exception("Invalid scale factor",WCS20Exception.WCS20ExceptionCode.InvalidScaleFactor,Double.toString(scaleFactorX));
  }
  final double scaleFactorY=yScale.getScaleFactor();
  if (scaleFactorY < 0) {
    throw new WCS20Exception("Invalid scale factor",WCS20Exception.WCS20ExceptionCode.InvalidScaleFactor,Double.toString(scaleFactorY));
  }
  if (scaleFactorX == 1.0 && scaleFactorY == 1.0) {
    return sourceGC;
  }
  return (GridCoverage2D)Operations.DEFAULT.scale(sourceGC,scaleFactorX,scaleFactorY,0,0);
}
