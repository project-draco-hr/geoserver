{
  GeoServerPasswordEncoder enc=getSecurityManager().loadPasswordEncoder(getPasswordEncoderName());
  if (enc.isResponsibleForEncoding(user.getPassword()))   return;
  getSecurityManager().loadPasswordValidator(getPasswordValidatorName()).validatePassword(user.getPassword() != null ? user.getPassword().toCharArray() : null);
  enc.initializeFor(this);
  user.setPassword(enc.encodePassword(user.getPassword(),null));
}
