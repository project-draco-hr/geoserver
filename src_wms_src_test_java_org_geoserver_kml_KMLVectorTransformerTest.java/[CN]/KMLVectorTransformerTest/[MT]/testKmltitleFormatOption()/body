{
  SimpleFeatureCollection features=FeatureCollections.newCollection();
  Style style=mockData.getDefaultStyle().getStyle();
  Layer layer=new FeatureLayer(features,style);
  WMSMapContent mapContent=new WMSMapContent();
  GetMapRequest request=mockData.createRequest();
  mapContent.setRequest(request);
  Map<String,Object> formatOptions=new HashMap<String,Object>();
  formatOptions.put("kmltitle","myCustomLayerTitle");
  mapContent.getRequest().setFormatOptions(formatOptions);
  KMLVectorTransformer transformer=new KMLVectorTransformer(mockData.getWMS(),mapContent,layer);
  Document document;
  transformer.setStandAlone(true);
  document=WMSTestSupport.transform(features,transformer);
  assertEquals("kml",document.getDocumentElement().getNodeName());
  assertEquals("Document",document.getDocumentElement().getFirstChild().getNodeName());
  assertEquals("myCustomLayerTitle",document.getDocumentElement().getFirstChild().getFirstChild().getTextContent());
}
