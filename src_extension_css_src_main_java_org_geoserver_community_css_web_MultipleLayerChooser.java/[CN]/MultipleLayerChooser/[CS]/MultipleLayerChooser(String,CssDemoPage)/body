{
  super(id);
  this.demo=demo;
  final LayerProvider layerProvider=new LayerProvider(demo);
  GeoServerTablePanel layerTable=new GeoServerTablePanel<LayerInfo>("layer.table",layerProvider){
    @Override public Component getComponentForProperty(    String id,    IModel value,    Property<LayerInfo> property){
      final LayerInfo layer=(LayerInfo)value.getObject();
      String text=property.getPropertyValue(layer).toString();
      if (property == layerProvider.associated) {
        IModel<Boolean> model=new IModel<java.lang.Boolean>(){
          public Boolean getObject(){
            return usesEditedStyle(layer);
          }
          public void setObject(          java.lang.Boolean b){
            if (b) {
              layer.getStyles().add(demo.getStyleInfo());
            }
 else {
              if (layer.getDefaultStyle().getName() == demo.getStyleInfo().getName()) {
                if (layer.getStyles().size() == 0) {
                  layer.setDefaultStyle(demo.catalog().getStyleByName("point"));
                }
 else {
                  StyleInfo s=layer.getStyles().iterator().next();
                  layer.setDefaultStyle(s);
                  layer.getStyles().remove(s);
                }
              }
 else {
                StyleInfo s=null;
                for (                StyleInfo candidate : layer.getStyles()) {
                  if (candidate.getName().equals(demo.getStyleInfo().getName())) {
                    s=candidate;
                    break;
                  }
                }
                if (s != null)                 layer.getStyles().remove(s);
              }
            }
            demo.catalog().save(layer);
          }
          public void detach(){
          }
        }
;
        Fragment fragment=new Fragment(id,"layer.association.checkbox",MultipleLayerChooser.this);
        fragment.add(new AjaxCheckBox("selected",model){
          public void onUpdate(          AjaxRequestTarget target){
          }
        }
);
        return fragment;
      }
 else {
        return new Label(id,text);
      }
    }
  }
;
  add(layerTable);
}
