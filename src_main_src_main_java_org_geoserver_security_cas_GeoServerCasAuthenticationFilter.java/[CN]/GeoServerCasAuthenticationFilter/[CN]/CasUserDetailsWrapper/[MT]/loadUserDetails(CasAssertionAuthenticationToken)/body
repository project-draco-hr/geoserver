{
  if (GeoServerUser.ROOT_USERNAME.equals(authentication.getName()))   return GeoServerUser.createRoot();
  UserDetails result=super.loadUserDetails(authentication);
  if ((result != null) && result.getAuthorities().contains(GeoServerRole.AUTHENTICATED_ROLE) == false) {
    List<GrantedAuthority> roles=new ArrayList<GrantedAuthority>();
    roles.addAll(result.getAuthorities());
    roles.add(GeoServerRole.AUTHENTICATED_ROLE);
    return new CasUserDetails(result,roles);
  }
  return result;
}
