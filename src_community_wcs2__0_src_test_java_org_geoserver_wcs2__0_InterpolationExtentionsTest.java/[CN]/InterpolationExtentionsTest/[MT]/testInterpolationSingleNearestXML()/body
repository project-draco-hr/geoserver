{
  final File xml=new File("./src/test/resources/requestGetCoverageInterpolationNearest.xml");
  final String request=FileUtils.readFileToString(xml);
  MockHttpServletResponse response=postAsServletResponse("wcs",request);
  assertEquals("image/tiff",response.getContentType());
  byte[] tiffContents=getBinary(response);
  File file=File.createTempFile("bm_gtiff","bm_gtiff.tiff",new File("./target"));
  FileUtils.writeByteArrayToFile(file,tiffContents);
  final TIFFImageReader reader=(TIFFImageReader)new TIFFImageReaderSpi().createReaderInstance();
  reader.setInput(new FileImageInputStream(file));
  assertEquals(360,reader.getWidth(0));
  assertEquals(360,reader.getHeight(0));
  reader.dispose();
  final GeoTiffReader readerGT=new GeoTiffReader(file);
  Assert.assertTrue(CRS.equalsIgnoreMetadata(readerGT.getCrs(),CRS.decode("EPSG:4326",true)));
  assertEquals(360,readerGT.getOriginalGridRange().getSpan(0));
  assertEquals(360,readerGT.getOriginalGridRange().getSpan(1));
  final GridCoverage2D coverage=readerGT.read(null);
  final GridCoverage2D sourceCoverage=(GridCoverage2D)this.getCatalog().getCoverageByName("BlueMarble").getGridCoverageReader(null,null).read(null);
  assertEnvelopeEquals(sourceCoverage,coverage);
  readerGT.dispose();
  scheduleForCleaning(coverage);
  scheduleForCleaning(sourceCoverage);
}
