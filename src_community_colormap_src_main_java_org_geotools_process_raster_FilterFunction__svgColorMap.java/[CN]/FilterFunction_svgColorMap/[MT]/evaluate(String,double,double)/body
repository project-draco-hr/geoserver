{
  GradientColorMapGenerator generator=null;
  File xmlFile=null;
  if (!colorMap.startsWith(GradientColorMapGenerator.RGB_INLINEVALUE_MARKER) && !colorMap.startsWith(GradientColorMapGenerator.HEX_INLINEVALUE_MARKER)) {
    colorMap=colorMap.replace('\\',File.separatorChar);
    xmlFile=GeoserverDataDirectory.findStyleFile(STYLES_RAMP + colorMap + ".svg");
    if (xmlFile == null || !xmlFile.exists() || !xmlFile.canRead()) {
      throw new IllegalArgumentException("The specified colorMap do not exist in the styles/ramp folder\n" + "Check that " + GeoserverDataDirectory.getGeoserverDataDirectory() + File.separatorChar+ "styles"+ File.separatorChar+ "ramp"+ " contains a "+ colorMap+ ".svg file");
    }
  }
  try {
    if (xmlFile != null) {
      generator=GradientColorMapGenerator.getColorMapGenerator(xmlFile);
    }
 else {
      generator=GradientColorMapGenerator.getColorMapGenerator(colorMap);
    }
    return generator.generateColorMap(min,max);
  }
 catch (  Exception e) {
    throw new IllegalArgumentException("Filter Function problem for function colormap",e);
  }
}
