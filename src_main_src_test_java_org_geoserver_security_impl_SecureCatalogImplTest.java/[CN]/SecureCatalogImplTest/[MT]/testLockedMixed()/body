{
  ResourceAccessManager manager=buildManager("lockedDownMixed.properties");
  SecureCatalogImpl sc=new SecureCatalogImpl(catalog,manager);
  SecurityContextHolder.getContext().setAuthentication(roUser);
  Request request=org.easymock.classextension.EasyMock.createNiceMock(Request.class);
  org.easymock.classextension.EasyMock.expect(request.getRequest()).andReturn("GetFeatures").anyTimes();
  org.easymock.classextension.EasyMock.replay(request);
  Dispatcher.REQUEST.set(request);
  try {
    sc.getFeatureTypeByName("topp:states");
    fail("Should have failed with a security exception");
  }
 catch (  Exception e) {
    if (ReadOnlyDataStoreTest.isSpringSecurityException(e) == false)     fail("Should have failed with a security exception");
  }
  try {
    sc.getCoverageByName("nurc:arcgrid");
    fail("Should have failed with a security exception");
  }
 catch (  Exception e) {
    if (ReadOnlyDataStoreTest.isSpringSecurityException(e) == false)     fail("Should have failed with a security exception");
  }
  try {
    sc.getResourceByName("topp:states",FeatureTypeInfo.class);
    fail("Should have failed with a security exception");
  }
 catch (  Exception e) {
    if (ReadOnlyDataStoreTest.isSpringSecurityException(e) == false)     fail("Should have failed with a security exception");
  }
  try {
    sc.getResourceByName("nurc:arcgrid",CoverageInfo.class);
    fail("Should have failed with a security exception");
  }
 catch (  Exception e) {
    if (ReadOnlyDataStoreTest.isSpringSecurityException(e) == false)     fail("Should have failed with a security exception");
  }
  try {
    sc.getWorkspaceByName("topp");
    fail("Should have failed with a security exception");
  }
 catch (  Exception e) {
    if (ReadOnlyDataStoreTest.isSpringSecurityException(e) == false)     fail("Should have failed with a security exception");
  }
  try {
    sc.getDataStoreByName("states");
    fail("Should have failed with a security exception");
  }
 catch (  Exception e) {
    if (ReadOnlyDataStoreTest.isSpringSecurityException(e) == false)     fail("Should have failed with a security exception");
  }
  try {
    sc.getDataStoreByName("roads");
    fail("Should have failed with a security exception");
  }
 catch (  Exception e) {
    if (ReadOnlyDataStoreTest.isSpringSecurityException(e) == false)     fail("Should have failed with a security exception");
  }
  try {
    sc.getCoverageStoreByName("arcGrid");
    fail("Should have failed with a security exception");
  }
 catch (  Exception e) {
    if (ReadOnlyDataStoreTest.isSpringSecurityException(e) == false)     fail("Should have failed with a security exception");
  }
  request=org.easymock.classextension.EasyMock.createNiceMock(Request.class);
  org.easymock.classextension.EasyMock.expect(request.getRequest()).andReturn("GetCapabilities").anyTimes();
  org.easymock.classextension.EasyMock.replay(request);
  Dispatcher.REQUEST.set(request);
  assertEquals(0,sc.getFeatureTypes().size());
  assertEquals(0,sc.getCoverages().size());
  assertEquals(0,sc.getWorkspaces().size());
  SecurityContextHolder.getContext().setAuthentication(rwUser);
  assertSame(states,sc.getFeatureTypeByName("topp:states"));
  assertSame(arcGrid,sc.getCoverageByName("nurc:arcgrid"));
  assertSame(states,sc.getResourceByName("topp:states",FeatureTypeInfo.class));
  assertSame(arcGrid,sc.getResourceByName("nurc:arcgrid",CoverageInfo.class));
  assertEquals(featureTypes,sc.getFeatureTypes());
  assertEquals(coverages,sc.getCoverages());
  assertEquals(workspaces,sc.getWorkspaces());
  assertEquals(toppWs,sc.getWorkspaceByName("topp"));
  assertSame(statesStore,sc.getDataStoreByName("states"));
  assertSame(roadsStore,sc.getDataStoreByName("roads"));
  assertSame(arcGridStore,sc.getCoverageStoreByName("arcGrid"));
}
