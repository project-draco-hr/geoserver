{
  try {
    resourceManager.setCurrentExecutionId(executionId);
    ExecuteResponseBuilder responseBuilder=new ExecuteResponseBuilder(request.getRequest(),applicationContext,started);
    responseBuilder.setExecutionId(executionId);
    try {
      Map<String,Object> outputs=processManager.getOutput(executionId,-1);
      responseBuilder.setOutputs(outputs);
    }
 catch (    Exception exception) {
      LOGGER.log(Level.SEVERE,"Request " + executionId + " failed during execution",exception);
      responseBuilder.setException(exception);
    }
    File output=resourceManager.getStoredResponseFile(executionId);
    try {
      writeOutResponse(responseBuilder,output);
    }
 catch (    Exception e) {
      LOGGER.log(Level.SEVERE,"Request failed during output encoding",e);
      responseBuilder.setException(e);
      writeOutResponse(responseBuilder,output);
    }
  }
 catch (  Exception e) {
    LOGGER.log(Level.SEVERE,"Failed to write out the stored WPS response for executionId " + executionId,e);
  }
 finally {
    contexts.remove(executionId);
  }
}
