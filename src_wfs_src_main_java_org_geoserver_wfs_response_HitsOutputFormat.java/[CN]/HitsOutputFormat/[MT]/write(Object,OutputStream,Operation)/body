{
  WFSInfo wfs=getInfo();
  FeatureCollectionType featureCollection=(FeatureCollectionType)value;
  FeatureCollectionType hits=WfsFactory.eINSTANCE.createFeatureCollectionType();
  if (GML3OutputFormat.isComplexFeature(featureCollection)) {
    hits.setNumberOfFeatures(countFeature(featureCollection));
  }
 else {
    hits.setNumberOfFeatures(featureCollection.getNumberOfFeatures());
  }
  hits.setTimeStamp(featureCollection.getTimeStamp());
  Encoder encoder=new Encoder(configuration,configuration.schema());
  encoder.setEncoding(Charset.forName(wfs.getGeoServer().getGlobal().getCharset()));
  encoder.setSchemaLocation(org.geoserver.wfs.xml.v1_1_0.WFS.NAMESPACE,ResponseUtils.appendPath(wfs.getSchemaBaseURL(),"wfs/1.1.0/wfs.xsd"));
  encoder.encode(hits,org.geoserver.wfs.xml.v1_1_0.WFS.FEATURECOLLECTION,output);
}
