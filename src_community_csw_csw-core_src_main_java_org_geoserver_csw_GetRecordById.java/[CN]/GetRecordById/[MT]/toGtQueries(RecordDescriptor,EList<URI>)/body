{
  Set<Name> supportedTypes=getSupportedTypes();
  Set<FeatureId> fids=new HashSet<FeatureId>();
  for (  URI id : ids) {
    fids.add(FF.featureId(id.toString()));
  }
  Filter filter=FF.id(fids);
  List<Query> result=new ArrayList<Query>();
  for (  Name typeName : getSupportedTypes()) {
    if (!supportedTypes.contains(typeName)) {
      throw new ServiceException("Unsupported record type " + typeName,ServiceException.INVALID_PARAMETER_VALUE,"typeNames");
    }
    Query q=new Query(typeName.getLocalPart());
    q.setFilter(filter);
    Query adapted=rd.adaptQuery(q);
    if (q.getFilter() != null) {
      q.getFilter().accept(new SpatialFilterChecker(rd.getFeatureType()),null);
    }
    result.add(adapted);
  }
  return result;
}
