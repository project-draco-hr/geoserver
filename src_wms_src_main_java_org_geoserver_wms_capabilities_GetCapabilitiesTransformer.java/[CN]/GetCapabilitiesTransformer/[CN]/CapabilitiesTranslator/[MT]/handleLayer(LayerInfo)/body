{
  AttributesImpl qatts=new AttributesImpl();
  boolean queryable=wmsConfig.isQueryable(layer);
  qatts.addAttribute("","queryable","queryable","",queryable ? "1" : "0");
  boolean opaque=wmsConfig.isOpaque(layer);
  qatts.addAttribute("","opaque","opaque","",opaque ? "1" : "0");
  Integer cascaded=wmsConfig.getCascadedHopCount(layer);
  if (cascaded != null) {
    qatts.addAttribute("","cascaded","cascaded","",String.valueOf(cascaded));
  }
  start("Layer",qatts);
  element("Name",layer.prefixedName());
  element("Title",layer.getResource().getTitle());
  element("Abstract",layer.getResource().getAbstract());
  handleKeywordList(layer.getResource().getKeywords());
  final String srs=layer.getResource().getSRS();
  element("SRS",srs);
  try {
    CoordinateReferenceSystem crs=layer.getResource().getCRS();
    String desc="WKT definition of this CRS:\n" + crs;
    comment(desc);
  }
 catch (  Exception e) {
    if (LOGGER.isLoggable(Level.WARNING)) {
      LOGGER.log(Level.WARNING,e.getLocalizedMessage(),e);
    }
  }
  ReferencedEnvelope bbox;
  try {
    bbox=layer.getResource().boundingBox();
  }
 catch (  Exception e) {
    throw new RuntimeException("Unexpected error obtaining bounding box for layer " + layer.getName(),e);
  }
  Envelope llbbox=layer.getResource().getLatLonBoundingBox();
  handleLatLonBBox(llbbox);
  if (bbox != null) {
    handleBBox(bbox,srs);
    handleAdditionalBBox(bbox,srs,layer);
  }
  if (layer.getType() == PublishedType.VECTOR) {
    dimensionHelper.handleVectorLayerDimensions(layer);
  }
 else   if (layer.getType() == PublishedType.RASTER) {
    dimensionHelper.handleRasterLayerDimensions(layer);
  }
  handleAttribution(layer);
  handleAuthorityURL(layer.getAuthorityURLs());
  handleLayerIdentifiers(layer.getIdentifiers());
  handleMetadataList(layer.getResource().getMetadataLinks());
  if (layer.getResource() instanceof WMSLayerInfo) {
  }
 else {
    start("Style");
    StyleInfo defaultStyle=layer.getDefaultStyle();
    if (defaultStyle == null) {
      throw new NullPointerException("Layer " + layer.getName() + " has no default style");
    }
    Style ftStyle;
    try {
      ftStyle=defaultStyle.getStyle();
    }
 catch (    IOException e) {
      throw new RuntimeException(e);
    }
    element("Name",defaultStyle.getName());
    element("Title",ftStyle.getTitle());
    element("Abstract",ftStyle.getAbstract());
    handleLegendURL(layer,layer.getLegend(),null,layer.getDefaultStyle());
    end("Style");
    Set<StyleInfo> styles=layer.getStyles();
    for (    StyleInfo styleInfo : styles) {
      try {
        ftStyle=styleInfo.getStyle();
      }
 catch (      IOException e) {
        throw new RuntimeException(e);
      }
      start("Style");
      element("Name",styleInfo.getName());
      element("Title",ftStyle.getTitle());
      element("Abstract",ftStyle.getAbstract());
      handleLegendURL(layer,null,styleInfo,styleInfo);
      end("Style");
    }
  }
  handleScaleHint(layer);
  end("Layer");
}
