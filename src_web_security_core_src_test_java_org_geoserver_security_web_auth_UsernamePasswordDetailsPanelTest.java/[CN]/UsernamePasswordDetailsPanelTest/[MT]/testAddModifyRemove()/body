{
  initializeForXML();
  activatePanel();
  assertEquals(1,countItmes());
  assertNotNull(getSecurityNamedServiceConfig("default"));
  assertNull(getSecurityNamedServiceConfig("xxxxxxxx"));
  clickAddNew();
  tester.assertRenderedPage(SecurityNamedServiceNewPage.class);
  setSecurityConfigClassName(UsernamePasswordAuthProviderPanelInfo.class);
  newFormTester();
  setSecurityConfigName("default2");
  setUGName("default");
  clickCancel();
  tester.assertRenderedPage(basePage.getClass());
  assertEquals(1,countItmes());
  assertNotNull(getSecurityNamedServiceConfig("default"));
  clickAddNew();
  newFormTester();
  setSecurityConfigClassName(UsernamePasswordAuthProviderPanelInfo.class);
  newFormTester();
  setSecurityConfigName("default2");
  setUGName("default");
  tester.assertRenderedPage(SecurityNamedServiceNewPage.class);
  clickSave();
  tester.assertRenderedPage(basePage.getClass());
  assertEquals(2,countItmes());
  assertNotNull(getSecurityNamedServiceConfig("default"));
  UsernamePasswordAuthenticationProviderConfig authConfig=(UsernamePasswordAuthenticationProviderConfig)getSecurityNamedServiceConfig("default2");
  assertNotNull(authConfig);
  assertEquals("default2",authConfig.getName());
  assertEquals(UsernamePasswordAuthenticationProvider.class.getName(),authConfig.getClassName());
  assertEquals("default",authConfig.getUserGroupServiceName());
  authConfig=(UsernamePasswordAuthenticationProviderConfig)getSecurityManager().loadAuthenticationProviderConfig("default2");
  assertNotNull(authConfig);
  assertEquals("default2",authConfig.getName());
  assertEquals(UsernamePasswordAuthenticationProvider.class.getName(),authConfig.getClassName());
  assertEquals("default",authConfig.getUserGroupServiceName());
  clickAddNew();
  newFormTester();
  setSecurityConfigClassName(UsernamePasswordAuthProviderPanelInfo.class);
  newFormTester();
  setSecurityConfigName("default2");
  setUGName("default");
  clickSave();
  tester.assertRenderedPage(SecurityNamedServiceNewPage.class);
  testErrorMessagesWithRegExp(".*default2.*");
  clickCancel();
  tester.assertRenderedPage(basePage.getClass());
  clickNamedServiceConfig("default");
  tester.assertRenderedPage(SecurityNamedServiceEditPage.class);
  tester.debugComponentTrees();
  newFormTester("panel:panel:form");
  formTester.setValue("panel:userGroupServiceName","test");
  clickCancel();
  tester.assertRenderedPage(basePage.getClass());
  authConfig=(UsernamePasswordAuthenticationProviderConfig)getSecurityNamedServiceConfig("default");
  assertEquals("default",authConfig.getUserGroupServiceName());
  clickNamedServiceConfig("default2");
  newFormTester("panel:panel:form");
  formTester.setValue("panel:userGroupServiceName","test");
  clickSave();
  tester.assertRenderedPage(basePage.getClass());
  authConfig=(UsernamePasswordAuthenticationProviderConfig)getSecurityNamedServiceConfig("default2");
  assertEquals("test",authConfig.getUserGroupServiceName());
  authConfig=(UsernamePasswordAuthenticationProviderConfig)getSecurityManager().loadAuthenticationProviderConfig("default2");
  assertEquals("test",authConfig.getUserGroupServiceName());
}
