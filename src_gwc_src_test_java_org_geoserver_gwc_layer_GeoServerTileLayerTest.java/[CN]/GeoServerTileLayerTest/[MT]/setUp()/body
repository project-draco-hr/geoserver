{
  mockGWC=mock(GWC.class);
  MemoryLockProvider lockProvider=new MemoryLockProvider();
  when(mockGWC.getLockProvider()).thenReturn(lockProvider);
  GWC.set(mockGWC);
  final String layerInfoId="mock-layer-info";
  NamespaceInfo ns=new NamespaceInfoImpl();
  ns.setPrefix("test");
  ns.setURI("http://goserver.org/test");
  DataStoreInfoImpl storeInfo=new DataStoreInfoImpl(null);
  storeInfo.setId("mock-store-info");
  storeInfo.setEnabled(true);
  FeatureTypeInfoImpl resource=new FeatureTypeInfoImpl((Catalog)null);
  resource.setStore(storeInfo);
  resource.setId("mock-resource-info");
  resource.setName("MockLayerInfoName");
  resource.setNamespace(ns);
  resource.setTitle("Test resource title");
  resource.setAbstract("Test resource abstract");
  resource.setEnabled(true);
  resource.setDescription("Test resource description");
  resource.setLatLonBoundingBox(new ReferencedEnvelope(-180,-90,0,0,DefaultGeographicCRS.WGS84));
  resource.setNativeBoundingBox(new ReferencedEnvelope(-180,-90,0,0,DefaultGeographicCRS.WGS84));
  resource.setSRS("EPSG:4326");
  resource.setKeywords((List)Arrays.asList(new Keyword("kwd1"),new Keyword("kwd2")));
  layerInfo=new LayerInfoImpl();
  layerInfo.setId(layerInfoId);
  layerInfo.setEnabled(true);
  layerInfo.setResource(resource);
  layerInfo.setName("MockLayerInfoName");
  layerInfo.setType(Type.VECTOR);
  StyleInfo defaultStyle=new StyleInfoImpl(null);
  defaultStyle.setName("default_style");
  layerInfo.setDefaultStyle(defaultStyle);
  StyleInfo alternateStyle1=new StyleInfoImpl(null);
  alternateStyle1.setName("alternateStyle-1");
  StyleInfo alternateStyle2=new StyleInfoImpl(null);
  alternateStyle2.setName("alternateStyle-2");
  Set<StyleInfo> alternateStyles=new HashSet<StyleInfo>(Arrays.asList(alternateStyle1,alternateStyle2));
  layerInfo.setStyles(alternateStyles);
  layerGroup=new LayerGroupInfoImpl();
  final String layerGroupId="mock-layergroup-id";
  layerGroup.setId(layerGroupId);
  layerGroup.setName("MockLayerGroup");
  layerGroup.setLayers(Collections.singletonList((PublishedInfo)layerInfo));
  defaults=GWCConfig.getOldDefaults();
  catalog=mock(Catalog.class);
  when(catalog.getLayer(eq(layerInfoId))).thenReturn(layerInfo);
  when(catalog.getLayerGroup(eq(layerGroupId))).thenReturn(layerGroup);
  gridSetBroker=new GridSetBroker(true,true);
  gridSetBroker.put(gridSetBroker.WORLD_EPSG4326);
  gridSetBroker.put(gridSetBroker.WORLD_EPSG3857);
}
