{
  KMLTransformer transformer=new KMLTransformer(getWMS());
  mapContent.removeLayer(mapContent.layers().get(0));
  mapContent.addLayer(createMapLayer(MockData.STREAMS,"big-local-image"));
  mapContent.getViewport().setBounds(new ReferencedEnvelope(-180,0,-90,90,DefaultGeographicCRS.WGS84));
  mapContent.setMapHeight(256);
  mapContent.setMapWidth(256);
  Document document=WMSTestSupport.transform(mapContent,transformer,false);
  assertEquals("kml",document.getDocumentElement().getNodeName());
  assertEquals(1,document.getElementsByTagName("Style").getLength());
  XPath xPath=XPathFactory.newInstance().newXPath();
  Double scale=(Double)xPath.evaluate("//Style[1]/IconStyle/scale",document.getDocumentElement(),XPathConstants.NUMBER);
  assertThat(scale,closeTo(42d / 16d,0.01));
}
