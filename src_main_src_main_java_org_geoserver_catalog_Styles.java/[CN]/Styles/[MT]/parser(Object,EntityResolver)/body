{
  SLDParser parser;
  if (input instanceof File) {
    parser=new SLDParser(styleFactory,(File)input);
  }
 else {
    parser=new SLDParser(styleFactory,toReader(input));
  }
  GeoServerDataDirectory dd=GeoServerExtensions.bean(GeoServerDataDirectory.class);
  File styles=dd.findOrCreateStyleDir().getCanonicalFile();
  DefaultResourceLocator rl=new DefaultResourceLocator();
  rl.setSourceUrl(DataUtilities.fileToURL(styles));
  parser.setOnLineResourceLocator(rl);
  parser.setEntityResolver(entityResolver);
  return parser;
}
