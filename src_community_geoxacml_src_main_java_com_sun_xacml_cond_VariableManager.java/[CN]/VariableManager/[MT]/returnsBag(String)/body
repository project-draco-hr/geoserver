{
  VariableState state=(VariableState)(idMap.get(variableId));
  if (state == null)   throw new ProcessingException("variable not supported: " + variableId);
  if (state.type != null)   return state.returnsBag;
  VariableDefinition definition=state.definition;
  if (definition == null)   definition=getDefinition(variableId);
  if (definition != null)   return definition.getExpression().returnsBag();
  throw new ProcessingException("couldn't establish bag return for " + variableId);
}
