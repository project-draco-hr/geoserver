{
  BasicDataSource dataSource=new BasicDataSource();
  dataSource.setUrl(config.getJdbcUrl());
  String driverClassName=get(config,"driverClassName",String.class,true,null);
  try {
    Class.forName(driverClassName);
  }
 catch (  Exception e) {
    throw new RuntimeException("Error loading jdbc driver class: " + driverClassName,e);
  }
  dataSource.setDriverClassName(driverClassName);
  dataSource.setUsername(get(config,"username",String.class,false,null));
  dataSource.setPassword(get(config,"password",String.class,false,null));
  return dataSource;
}
