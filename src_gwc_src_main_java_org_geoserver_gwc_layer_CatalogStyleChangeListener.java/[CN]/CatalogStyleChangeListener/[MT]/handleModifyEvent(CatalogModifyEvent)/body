{
  CatalogInfo source=event.getSource();
  if (!(source instanceof StyleInfo)) {
    return;
  }
  final List<String> propertyNames=event.getPropertyNames();
  if (!propertyNames.contains("name")) {
    return;
  }
  final int index=propertyNames.indexOf("name");
  final String oldStyleName=(String)event.getOldValues().get(index);
  final String newStyleName=(String)event.getNewValues().get(index);
  if (oldStyleName.equals(newStyleName)) {
    return;
  }
  List<GeoServerTileLayer> affectedLayers;
  affectedLayers=mediator.getTileLayersForStyle(oldStyleName);
  for (  GeoServerTileLayer tl : affectedLayers) {
    LayerInfo layerInfo=tl.getLayerInfo();
    if (layerInfo == null) {
      continue;
    }
    GeoServerTileLayerInfo info=tl.getInfo();
    ImmutableSet<String> styleNames=info.cachedStyles();
    if (styleNames.contains(oldStyleName)) {
      tl.resetParameterFilters();
      mediator.truncateByLayerAndStyle(tl.getName(),oldStyleName);
      Set<String> newStyles=new HashSet<String>(styleNames);
      newStyles.remove(oldStyleName);
      newStyles.add(newStyleName);
      String defaultStyle=layerInfo.getDefaultStyle() == null ? null : layerInfo.getDefaultStyle().getName();
      TileLayerInfoUtil.setCachedStyles(info,defaultStyle,newStyles);
      mediator.save(tl);
    }
  }
}
