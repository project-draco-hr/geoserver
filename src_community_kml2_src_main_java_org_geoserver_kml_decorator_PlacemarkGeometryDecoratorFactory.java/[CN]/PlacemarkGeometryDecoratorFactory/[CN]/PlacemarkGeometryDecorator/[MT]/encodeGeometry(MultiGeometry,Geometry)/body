{
  if (geometry instanceof GeometryCollection) {
    GeometryCollection gc=(GeometryCollection)geometry;
    for (int i=0; i < gc.getNumGeometries(); i++) {
      Geometry child=gc.getGeometryN(i);
      encodeGeometry(mg,child);
    }
  }
 else   if (geometry instanceof Point) {
    de.micromata.opengis.kml.v_2_2_0.Point kmlPoint=toKmlPoint(geometry.getCoordinate());
    mg.addToGeometry(kmlPoint);
  }
 else   if (geometry instanceof LinearRing) {
    de.micromata.opengis.kml.v_2_2_0.LinearRing kmlLine=convertLinearRing((LinearRing)geometry);
    mg.addToGeometry(kmlLine);
  }
 else   if (geometry instanceof LineString) {
    de.micromata.opengis.kml.v_2_2_0.LineString kmlLine=new de.micromata.opengis.kml.v_2_2_0.LineString();
    List<de.micromata.opengis.kml.v_2_2_0.Coordinate> kmlCoordinates=dumpCoordinateSequence(((LineString)geometry).getCoordinateSequence());
    kmlLine.setCoordinates(kmlCoordinates);
    mg.addToGeometry(kmlLine);
  }
 else   if (geometry instanceof Polygon) {
    Polygon polygon=(Polygon)geometry;
    de.micromata.opengis.kml.v_2_2_0.Polygon kmlPolygon=new de.micromata.opengis.kml.v_2_2_0.Polygon();
    de.micromata.opengis.kml.v_2_2_0.LinearRing kmlOuterRing=convertLinearRing((LinearRing)polygon.getExteriorRing());
    kmlPolygon.createAndSetOuterBoundaryIs().setLinearRing(kmlOuterRing);
    for (int i=0; i < polygon.getNumInteriorRing(); i++) {
      LinearRing interior=(LinearRing)polygon.getInteriorRingN(i);
      de.micromata.opengis.kml.v_2_2_0.LinearRing kmlInterior=convertLinearRing(interior);
      kmlPolygon.createAndAddInnerBoundaryIs().setLinearRing(kmlInterior);
    }
    mg.addToGeometry(kmlPolygon);
  }
}
