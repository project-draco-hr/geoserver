{
  super.setUp();
  DeleteDbFiles.execute("target","bar",false);
  cat=new CatalogImpl();
  cat.setResourceLoader(scriptMgr.getDataDirectory().getResourceLoader());
  ApplicationContext context=createNiceMock(ApplicationContext.class);
  expect(context.getBean("catalog")).andReturn(cat).anyTimes();
  expect(context.getBeanNamesForType((Class)anyObject())).andReturn(new String[]{}).anyTimes();
  replay(context);
  new GeoServerExtensions().setApplicationContext(context);
  e=scriptMgr.createNewEngine("py");
  GeoserverDataDirectory.setResourceLoader(scriptMgr.getDataDirectory().getResourceLoader());
}
