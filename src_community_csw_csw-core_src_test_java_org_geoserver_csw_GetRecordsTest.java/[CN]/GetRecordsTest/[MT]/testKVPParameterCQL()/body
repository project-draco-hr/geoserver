{
  Map<String,Object> raw=new HashMap<String,Object>();
  raw.put("service","CSW");
  raw.put("version","2.0.2");
  raw.put("request","GetRecords");
  raw.put("namespace","xmlns(csw=http://www.opengis.net/cat/csw/2.0.2),xmlns(rim=urn:oasis:names:tc:ebxml-regrep:xsd:rim:3.0)");
  raw.put("resultType","results");
  raw.put("requestId","myId");
  raw.put("outputFormat","application/xml");
  raw.put("outputSchema","http://www.opengis.net/cat/csw/2.0.2");
  raw.put("startPosition","5");
  raw.put("maxRecords","20");
  raw.put("typenames","csw:Record,rim:RegistryPackage");
  raw.put("elementName","dc:title,dct:abstract");
  raw.put("constraintLanguage","CQL_TEXT");
  raw.put("constraint","AnyText like '%pollution%'");
  raw.put("sortby","title:A,abstract:D");
  raw.put("distributedSearch","true");
  raw.put("hopCount","10");
  raw.put("responsehandler","http://www.geoserver.org");
  GetRecordsKvpRequestReader reader=new GetRecordsKvpRequestReader();
  Object request=reader.createRequest();
  GetRecordsType gr=(GetRecordsType)reader.read(request,parseKvp(raw),raw);
  assertEquals("CSW",gr.getService());
  assertEquals("2.0.2",gr.getVersion());
  assertEquals(ResultType.RESULTS,gr.getResultType());
  assertEquals("myId",gr.getRequestId());
  assertEquals("application/xml",gr.getOutputFormat());
  assertEquals("http://www.opengis.net/cat/csw/2.0.2",gr.getOutputSchema());
  assertNotNull(gr.getDistributedSearch());
  assertEquals(new Integer(10),gr.getDistributedSearch().getHopCount());
  assertEquals("http://www.geoserver.org",gr.getResponseHandler());
  QueryType query=(QueryType)gr.getQuery();
  assertEquals("AnyText like '%pollution%'",query.getConstraint().getCqlText());
  assertEquals(2,query.getTypeNames().size());
  assertEquals(new QName("http://www.opengis.net/cat/csw/2.0.2","Record"),query.getTypeNames().get(0));
  assertEquals(new QName("urn:oasis:names:tc:ebxml-regrep:xsd:rim:3.0","RegistryPackage"),query.getTypeNames().get(1));
  assertEquals(2,query.getElementName().size());
  assertEquals(2,query.getElementName().size());
}
