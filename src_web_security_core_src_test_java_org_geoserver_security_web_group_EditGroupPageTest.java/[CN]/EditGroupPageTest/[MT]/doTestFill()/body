{
  insertValues();
  AbstractSecurityPage returnPage=initializeForUGServiceNamed(getUserGroupServiceName());
  tester.startPage(page=(EditGroupPage)new EditGroupPage(getUserGroupServiceName(),ugService.getGroupByGroupname("group1")).setReturnPage(returnPage));
  tester.assertRenderedPage(EditGroupPage.class);
  tester.assertRenderedPage(EditGroupPage.class);
  assertFalse(tester.getComponentFromLastRenderedPage("form:groupname").isEnabled());
  assertTrue(tester.getComponentFromLastRenderedPage("form:enabled").isEnabled());
  assertTrue(tester.getComponentFromLastRenderedPage("form:roles").isEnabled());
  tester.assertVisible("form:save");
  tester.assertModelValue("form:groupname","group1");
  tester.assertModelValue("form:enabled",Boolean.TRUE);
  FormTester form=tester.newFormTester("form");
  form.setValue("enabled",Boolean.FALSE);
  form.submit("roles:addRole");
  tester.assertRenderedPage(NewRolePage.class);
  form=tester.newFormTester("form");
  form.setValue("name","ROLE_NEW");
  form.submit("save");
  form=tester.newFormTester("form");
  tester.assertRenderedPage(EditGroupPage.class);
  form.setValue("roles:palette:recorder",gaService.getRoleByName("ROLE_NEW").getAuthority());
  form.submit("roles:addRole");
  tester.assertRenderedPage(NewRolePage.class);
  tester.clickLink("form:cancel");
  tester.assertRenderedPage(EditGroupPage.class);
  form=tester.newFormTester("form");
  form.submit("save");
  tester.assertRenderedPage(SecurityNamedServiceEditPage.class);
  tester.assertErrorMessages(new String[0]);
  GeoServerUserGroup group=ugService.getGroupByGroupname("group1");
  assertNotNull(group);
  assertFalse(group.isEnabled());
  SortedSet<GeoServerRole> roleList=gaService.getRolesForGroup("group1");
  assertEquals(1,roleList.size());
  assertEquals("ROLE_NEW",roleList.iterator().next().getAuthority());
}
