{
  WMSInfo wms=getGeoServer().getService(WMSInfo.class);
  wms.getSRS().add("EPSG:4326");
  wms.getMetadata().put(InspireMetadata.LANGUAGE.key,"fre");
  wms.getMetadata().put(InspireMetadata.SERVICE_METADATA_URL.key,"http://foo.com?bar=baz");
  wms.getMetadata().put(InspireMetadata.SERVICE_METADATA_TYPE.key,"application/vnd.iso.19139+xml");
  getGeoServer().save(wms);
  Document dom=getAsDOM(WMS_1_3_0_GETCAPREQUEST);
  assertEquals(VS_NAMESPACE,dom.getDocumentElement().getAttribute("xmlns:inspire_vs"));
  assertMetadataUrlAndMediaType(dom,"http://foo.com?bar=baz","application/vnd.iso.19139+xml");
  wms.getMetadata().put(InspireMetadata.SERVICE_METADATA_TYPE.key,"application/xml");
  getGeoServer().save(wms);
  dom=getAsDOM(WMS_1_3_0_GETCAPREQUEST);
  assertEquals(VS_NAMESPACE,dom.getDocumentElement().getAttribute("xmlns:inspire_vs"));
  assertMetadataUrlAndMediaType(dom,"http://foo.com?bar=baz","application/xml");
}
