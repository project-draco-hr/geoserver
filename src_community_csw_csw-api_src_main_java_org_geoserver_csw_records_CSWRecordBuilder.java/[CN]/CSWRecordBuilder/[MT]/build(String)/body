{
  Geometry geom=null;
  for (  ReferencedEnvelope env : boxes) {
    try {
      env=env.transform(CSWRecordDescriptor.DEFAULT_CRS,true);
      Polygon poly=JTS.toGeometry(env);
      poly.setUserData(CSWRecordDescriptor.DEFAULT_CRS);
      if (geom == null) {
        geom=poly;
      }
 else {
        geom=geom.union(poly);
      }
    }
 catch (    Exception e) {
      throw new IllegalArgumentException("Failed to reproject one of the bounding boxes to WGS84, " + "this should never happen with valid coordinates",e);
    }
  }
  if (geom instanceof Polygon) {
    geom=geom.getFactory().createMultiPolygon(new Polygon[]{(Polygon)geom});
  }
  ab.setDescriptor(CSWRecordDescriptor.RECORD_BBOX_DESCRIPTOR);
  Attribute element=ab.buildSimple(null,geom);
  element.getUserData().put(CSWRecordDescriptor.ORIGINAL_BBOXES,new ArrayList<ReferencedEnvelope>(boxes));
  fb.append(CSWRecordDescriptor.RECORD_BBOX_NAME,element);
  boxes.clear();
  return fb.buildFeature(id);
}
