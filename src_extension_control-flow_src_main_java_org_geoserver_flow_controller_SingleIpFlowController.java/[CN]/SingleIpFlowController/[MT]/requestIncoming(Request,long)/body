{
  boolean retval=true;
  String incomingIp=getRemoteAddr(request.getHttpRequest());
  if (incomingIp.equals(ipAddresses.get(0))) {
    TimedBlockingQueue queue=null;
    if (incomingIp != null && !incomingIp.equals("")) {
      queue=queues.get(incomingIp);
    }
    if (queue == null) {
      queue=new TimedBlockingQueue(queueSize,true);
      queues.put(incomingIp,queue);
    }
    QUEUE_ID.set(incomingIp);
    try {
      if (timeout > 0) {
        retval=queue.offer(request,timeout,TimeUnit.MILLISECONDS);
      }
 else {
        queue.put(request);
      }
    }
 catch (    InterruptedException e) {
      LOGGER.log(Level.WARNING,"Unexpected interruption while " + "blocking on the request queue");
    }
    if (LOGGER.isLoggable(Level.FINE)) {
      LOGGER.fine("SingleIpFlowController(" + queueSize + ","+ incomingIp+ ") queue size "+ queue.size());
      LOGGER.fine("SingleIpFlowController(" + queueSize + ","+ incomingIp+ ") total queues "+ queues.size());
    }
  }
  return retval;
}
