{
  GetFeatureRequest request=GetFeatureRequest.adapt(operation.getParameters()[0]);
  String outputFormat=request.getOutputFormat();
  String mimeType="";
  OgrFormat format=formats.get(outputFormat);
  if (format == null) {
    throw new WFSException("Unknown output format " + outputFormat);
  }
 else   if (format.singleFile && request.getQueries().size() <= 1) {
    if (format.mimeType != null) {
      mimeType=format.mimeType;
    }
 else {
      mimeType="application/octet-stream";
    }
  }
 else {
    mimeType="application/zip";
  }
  return mimeType;
}
