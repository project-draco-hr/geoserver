{
  String password="changeit";
  SslSocketConnector conn=new SslSocketConnector();
  conn.setPort(8443);
  File userHome=new File(System.getProperty("user.home"));
  File geoserverDir=new File(userHome,".geoserver");
  if (geoserverDir.exists() == false)   geoserverDir.mkdir();
  File keyStoreFile=new File(geoserverDir,"keystore.jks");
  try {
    assureSelfSignedServerCertificate(hostname,keyStoreFile,password);
  }
 catch (  Exception e) {
    log.log(Level.WARNING,"NO SSL available",e);
    return null;
  }
  conn.setKeystore(keyStoreFile.getAbsolutePath());
  conn.setKeyPassword(password);
  conn.setPassword(password);
  File javaHome=new File(System.getProperty("java.home"));
  File cacerts=new File(javaHome,"lib");
  cacerts=new File(cacerts,"security");
  cacerts=new File(cacerts,"cacerts");
  if (cacerts.exists() == false)   return null;
  conn.setTruststore(cacerts.getAbsolutePath());
  conn.setTrustPassword("changeit");
  return conn;
}
