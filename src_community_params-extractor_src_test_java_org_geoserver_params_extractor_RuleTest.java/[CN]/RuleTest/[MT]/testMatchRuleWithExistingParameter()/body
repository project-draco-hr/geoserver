{
  Rule rule=new RuleBuilder().withId("0").withMatch("^.*?(/([^/]+)/([^/]+))$").withParameter("CQL_FILTER").withTransform("CFCC='$2' AND CFCC='$3'").withCombine("$1 OR ($2)").build();
  UrlTransform urlTransform=new UrlTransform("/geoserver/tiger/wms/H11/D68",Utils.parseParameters(Optional.of("REQUEST=GetMap&CQL_FILTER=CFCC%3D%27Y56%27")));
  rule.apply(urlTransform);
  assertThat(urlTransform.toString(),is("/geoserver/tiger/wms?REQUEST=GetMap&CQL_FILTER=CFCC%3D%27Y56%27+OR+%28CFCC%3D%27H11%27+AND+CFCC%3D%27D68%27%29"));
}
