{
  LayerGroupInfo lg=getCatalog().getFactory().createLayerGroup();
  for (  LayerGroupEntry entry : lgEntryPanel.getEntries()) {
    lg.getLayers().add(entry.getLayer());
    lg.getStyles().add(entry.getStyle());
  }
  try {
    CoordinateReferenceSystem crs=envelopePanel.getCoordinateReferenceSystem();
    if (crs != null) {
      new CatalogBuilder(getCatalog()).calculateLayerGroupBounds(lg,crs);
    }
 else {
      new CatalogBuilder(getCatalog()).calculateLayerGroupBounds(lg);
    }
    return lg.getBounds();
  }
 catch (  Exception e) {
    throw new WicketRuntimeException(e);
  }
}
