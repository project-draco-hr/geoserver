{
  LockType type=THREAD_LOCK.get();
  if (type != null || requestTarget == null) {
    return;
  }
  if (GeoServerSecuredPage.class.isAssignableFrom(requestTarget)) {
    type=LockType.WRITE;
  }
  if (type == null) {
    type=LockType.READ;
  }
  THREAD_LOCK.set(type);
  locker.lock(type);
}
