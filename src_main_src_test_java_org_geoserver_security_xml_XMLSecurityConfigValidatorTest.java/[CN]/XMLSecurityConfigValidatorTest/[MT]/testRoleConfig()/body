{
  super.testRoleConfig();
  XMLRoleServiceConfig config=(XMLRoleServiceConfig)getRoleConfig(XMLRoleService.DEFAULT_NAME,XMLRoleService.class,XMLRoleService.DEFAULT_LOCAL_ADMIN_ROLE,XMLConstants.FILE_RR);
  boolean fail;
  fail=false;
  try {
    config.setName("default2");
    config.setCheckInterval(-1l);
    getSecurityManager().saveRoleService(config);
  }
 catch (  SecurityConfigException ex) {
    assertEquals(CHECK_INTERVAL_INVALID,ex.getId());
    assertEquals(0,ex.getArgs().length);
    LOGGER.info(ex.getMessage());
    fail=true;
  }
  assertTrue(fail);
  fail=false;
  try {
    config.setCheckInterval(999l);
    getSecurityManager().saveRoleService(config);
  }
 catch (  SecurityConfigException ex) {
    assertEquals(CHECK_INTERVAL_INVALID,ex.getId());
    assertEquals(0,ex.getArgs().length);
    LOGGER.info(ex.getMessage());
    fail=true;
  }
  assertTrue(fail);
  config.setCheckInterval(0);
  XMLRoleServiceConfig xmlConfig=(XMLRoleServiceConfig)getRoleConfig("test1",XMLRoleService.class,XMLRoleService.DEFAULT_LOCAL_ADMIN_ROLE,"test1.xml");
  try {
    getSecurityManager().saveRoleService(xmlConfig);
    getSecurityManager().removeRoleService(xmlConfig);
  }
 catch (  SecurityConfigException ex) {
    Assert.fail("Should work");
  }
  fail=false;
  xmlConfig=(XMLRoleServiceConfig)getRoleConfig("test2",XMLRoleService.class,XMLRoleService.DEFAULT_LOCAL_ADMIN_ROLE,"test2.xml");
  try {
    getSecurityManager().saveRoleService(xmlConfig);
    GeoServerRoleStore store=getSecurityManager().loadRoleService("test2").createStore();
    store.addRole(GeoServerRole.ADMIN_ROLE);
    store.store();
    getSecurityManager().removeRoleService(xmlConfig);
  }
 catch (  SecurityConfigException ex) {
    assertEquals(ROLE_SERVICE_NOT_EMPTY_$1,ex.getId());
    assertEquals("test2",ex.getArgs()[0]);
    fail=true;
  }
  assertTrue(fail);
  xmlConfig=(XMLRoleServiceConfig)getRoleConfig("test3",XMLRoleService.class,XMLRoleService.DEFAULT_LOCAL_ADMIN_ROLE,new File(getSecurityManager().getRoleRoot(),"test3.xml").getAbsolutePath());
  try {
    getSecurityManager().saveRoleService(xmlConfig);
    GeoServerRoleStore store=getSecurityManager().loadRoleService("test3").createStore();
    store.addRole(GeoServerRole.ADMIN_ROLE);
    store.store();
    getSecurityManager().removeRoleService(xmlConfig);
  }
 catch (  SecurityConfigException ex) {
    Assert.fail("Should work");
  }
  if (new XMLSecurityConfigValidator(getSecurityManager()).getTempDir() != null) {
    String invalidPath="abc" + File.separator + "def.xml";
    xmlConfig=(XMLRoleServiceConfig)getRoleConfig("test4",XMLRoleService.class,XMLRoleService.DEFAULT_LOCAL_ADMIN_ROLE,invalidPath);
    fail=false;
    try {
      getSecurityManager().saveRoleService(xmlConfig);
    }
 catch (    SecurityConfigException ex) {
      assertEquals(FILE_CREATE_FAILED_$1,ex.getId());
      assertEquals(invalidPath,ex.getArgs()[0]);
      fail=true;
    }
    assertTrue(fail);
  }
  xmlConfig=(XMLRoleServiceConfig)getRoleConfig("test4",XMLRoleService.class,XMLRoleService.DEFAULT_LOCAL_ADMIN_ROLE,"testModify.xml");
  try {
    getSecurityManager().saveRoleService(xmlConfig);
    xmlConfig.setValidating(true);
    getSecurityManager().saveRoleService(xmlConfig);
  }
 catch (  SecurityConfigException ex) {
    Assert.fail("Should work");
  }
  fail=false;
  try {
    xmlConfig.setFileName("xyz.xml");
    getSecurityManager().saveRoleService(xmlConfig);
  }
 catch (  SecurityConfigException ex) {
    assertEquals(FILENAME_CHANGE_INVALID_$2,ex.getId());
    assertEquals("testModify.xml",ex.getArgs()[0]);
    assertEquals("xyz.xml",ex.getArgs()[1]);
    fail=true;
  }
  assertTrue(fail);
}
