{
  LayerInfo existing=getLayerByName(layer.getName());
  if (existing != null && !existing.getId().equals(layer.getId())) {
    if (existing.getResource().getNamespace().equals(layer.getName())) {
      throw new IllegalArgumentException("Layer named '" + layer.getName() + "' already exists.");
    }
  }
  if (layer.getResource() == null) {
    throw new NullPointerException("Layer resource must not be null");
  }
  return postValidate(layer,isNew);
}
